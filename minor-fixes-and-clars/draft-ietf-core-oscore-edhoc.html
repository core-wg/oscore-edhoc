<!DOCTYPE html>
<html lang="en" class="Internet-Draft">
<head>
<meta charset="utf-8">
<meta content="Common,Latin" name="scripts">
<meta content="initial-scale=1.0" name="viewport">
<title>Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)</title>
<meta content="Francesca Palombini" name="author">
<meta content="Marco Tiloca" name="author">
<meta content="Rikard Höglund" name="author">
<meta content="Stefan Hristozov" name="author">
<meta content="Göran Selander" name="author">
<meta content="
       The lightweight authenticated key exchange protocol Ephemeral Diffie-Hellman Over COSE (EDHOC) can be run over the Constrained Application Protocol (CoAP) and used by two peers to establish a Security Context for the security protocol Object Security for Constrained RESTful Environments (OSCORE). This document details this use of the EDHOC protocol, by specifying a number of additional and optional mechanisms. These especially include an optimization approach for combining the execution of EDHOC with the first OSCORE transaction. This combination reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context. 
    " name="description">
<meta content="xml2rfc 3.20.1" name="generator">
<meta content="Internet-Draft" name="keyword">
<meta content="draft-ietf-core-oscore-edhoc-latest" name="ietf.draft">
<!-- Generator version information:
  xml2rfc 3.20.1
    Python 3.11.8
    ConfigArgParse 1.7
    google-i18n-address 3.1.0
    intervaltree 3.1.0
    Jinja2 3.1.2
    lxml 4.9.3
    platformdirs 4.2.0
    pycountry 22.3.5
    PyYAML 6.0.1
    requests 2.31.0
    setuptools 68.2.2
    six 1.16.0
    wcwidth 0.2.13
-->
<link href="draft-ietf-core-oscore-edhoc.xml" rel="alternate" type="application/rfc+xml">
<link href="#copyright" rel="license">
<style type="text/css">@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}

@font-face {
  font-family: 'Lora';
  font-style: italic;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Italic'), local('Lora-Italic'), url('https://martinthomson.github.io/rfc-css/fonts/lora-italic-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Lora Regular'), local('Lora-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/lora-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic-ext.woff2') format('woff2');
  unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-cyrillic.woff2') format('woff2');
  unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 700;
  font-display: swap;
  src: local('Lora Bold'), local('Lora-Bold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-bold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}
@font-face {
  font-family: 'Lora';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Lora SemiBold'), local('Lora-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/lora-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-vietnamese.woff2') format('woff2');
  unicode-range: U+0102-0103, U+0110-0111, U+1EA0-1EF9, U+20AB;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Cabin Condensed';
  font-style: normal;
  font-weight: 600;
  font-display: swap;
  src: local('Cabin Condensed SemiBold'), local('CabinCondensed-SemiBold'), url('https://martinthomson.github.io/rfc-css/fonts/cabincondensed-semibold-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin-ext.woff2') format('woff2');
  unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
}
@font-face {
  font-family: 'Oxygen Mono';
  font-style: normal;
  font-weight: 400;
  font-display: swap;
  src: local('Oxygen Mono'), local('OxygenMono-Regular'), url('https://martinthomson.github.io/rfc-css/fonts/oxygenmono-regular-latin.woff2') format('woff2');
  unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
}

:root {
  color-scheme: light dark;
  --background-color: #fff;
  --text-color: #222;
  --title-color: #191919;
  --link-color: #2a6496;
  --highlight-color: #f9f9f9;
  --line-color: #eee;
  --pilcrow-weak: #ddd;
  --pilcrow-strong: #bbb;
  --small-font-size: 14.5px;
  --font-mono: 'Oxygen Mono', monospace;
  scrollbar-color: #bbb #eee;
}
body {
  max-width: 600px;
  margin: 75px auto;
  padding: 0 5px;
  color: var(--text-color);
  background-color: var(--background-color);
  font: 16px/22px "Lora", serif;
  scroll-behavior: smooth;
}

.ears {
  display: none;
}

/* headings */
h1, h2, h3, h4, h5, h6 {
  font-family: "Cabin Condensed", sans-serif;
  font-weight: 600;
  margin: 0.8em 0 0.3em;
  font-size-adjust: 0.5;
  color: var(--title-color);
}
h1#title {
  font-size: 32px;
  line-height: 40px;
  clear: both;
}
h1#title, h1#rfcnum {
  margin: 1.5em 0 0.2em;
}
h1#rfcnum + h1#title {
  margin: 0.2em 0;
}

h1, h2, h3 {
  font-size: 22px;
  line-height: 27px;
}
h4, h5, h6 {
  font-size: 20px;
  line-height: 24px;
}

/* general structure */
.author {
  padding-bottom: 0.3em;
}
#abstract+p {
  font-size: 18px;
  line-height: 24px;
}
#abstract+p code, #abstract+p samp, #abstract+p tt {
  font-size: 16px;
  line-height: 0;
}

p {
  padding: 0;
  margin: 0.5em 0;
  text-align: left;
}
div {
  margin: 0;
}
.alignRight.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignRight.art-text pre {
  padding: 0;
  width: auto;
}
.alignRight {
  margin: 1em 0;
}
.alignRight > *:first-child {
  border: none;
  margin: 0;
  float: right;
  clear: both;
}
.alignRight > *:nth-child(2) {
  clear: both;
  display: block;
  border: none;
}
svg {
  display: block;
}
/* font-family isn't space-separated, but =~ will have to do */
svg[font-family~="monospace" i], svg [font-family~="monospace" i] {
  font-family: var(--font-mono);
}
.alignCenter.art-text {
  background-color: var(--highlight-color);
  border: 1px solid var(--line-color);
  border-radius: 3px;
  padding: 0.5em 1em 0;
  margin-bottom: 0.5em;
}
.alignCenter.art-text pre {
  padding: 0;
  width: auto;
}
.alignCenter {
  margin: 1em 0;
}
.alignCenter > *:first-child {
  border: none;
  /* this isn't optimal, but it's an existence proof.  PrinceXML doesn't
     support flexbox yet.
  */
  display: table;
  margin: 0 auto;
}

/* lists */
ol, ul {
  padding: 0;
  margin: 0 0 0.5em 2em;
}
:is(ol, ul) :is(ol, ul) {
  margin-left: 1em;
}
li {
  margin: 0 0 0.25em 0;
}
.ulCompact li {
  margin: 0;
}
ul.empty, .ulEmpty {
  list-style-type: none;
}
ul.empty li, .ulEmpty li {
  margin-top: 0.5em;
}
:is(ul, ol).compact, .ulCompact, .olCompact {
  line-height: 1;
  margin: 0 0 0 2em;
}

/* definition lists */
dl {
  clear: left;
  --indent: 3ch;
  /* --indent: attr(indent ch); not supported in any browser, but we can dream */
}
dl.olPercent {
  --indent: 5ch;
}
dl > dt {
  float: left;
  margin-right: 2ch;
  min-width: 8ch;
}
dl.dlNewline > dt {
  float: none;
}
dl > dd {
  margin-bottom: .8em;
  margin-left: var(--indent) !important; /* stupid element overrides */
  min-height: 2ex;
}
dl.olPercent > dt {
  min-width: calc(var(--indent) - 2ch);
}
:is(dl.compact, .dlCompact) > dd {
  margin-bottom: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:first-child, .break:first-child + *) {
  margin-top: 0;
}
:is(dl.compact, .dlCompact) > dd > :is(:last-child) {
  margin-bottom: 0;
}
dl > dd > dl {
  margin-top: 0.5em;
  margin-bottom: 0;
}
:is(dd, span).break {
  display: none;
}

/* links */
a, a[href].selfRef:hover {
  text-decoration: none;
}
a[href] {
  color: var(--link-color);
}
a[href].selfRef, .iref + a[href].internal {
  color: var(--text-color);
}
a[href]:hover {
  text-decoration: underline;
}
a[href].selfRef:hover {
  background-color: var(--highlight-color);
}
a.xref:is(.cite, .auto), :is(#status-of-memo, #copyright) a {
  white-space: nowrap;
}

/* Figures */
tt, code, pre {
  background-color: var(--highlight-color);
  font: 14px/22px var(--font-mono);
}
tt, code {
  /* changing the font for inline elements leads to different ascender
     and descender heights; as we want to retain baseline alignment,
     remove leading to avoid altering the final height of lines
     note: this fails if these blocks take an entire line,
     a different solution would be great */
  line-height: 0;
}
:is(h1, h2, h3, h4, h5, h6) :is(tt, code) {
  font-size: 84%;
}
pre {
  border: 1px solid var(--line-color);
  font-size: 13.5px;
  line-height: 16px;
  letter-spacing: -0.2px;
  margin: 5px;
  padding: 5px;
}
img {
  max-width: 100%;
}
figure {
  margin: 0.5em 0;
  padding: 0;
}
figure blockquote {
  margin: 0.8em 0.4em 0.4em;
}
figcaption, caption {
  font-style: italic;
  margin: 0.5em 1.5em;
  text-align: left;
}
@media screen {
  /* Auto-collapse boilerplate. */
  :is(#status-of-memo, #copyright) p {
    margin: -2px 0;
    max-height: 0;
    transition: max-height 2s ease, margin 0.5s ease 0.5s;
    overflow: hidden;
  }
  :is(#status-of-memo, #copyright):hover p,
  :is(#status-of-memo, #copyright) h2:target ~ p {
    margin: 0.5em 0;
    max-height: 500px;
    overflow: auto;
  }
  pre, svg {
    display: inline-block;
    overflow-x: auto;
  }
  pre {
    max-width: 100%;
    width: calc(100% - 22px - 1em);
  }
  svg {
    max-width: calc(100% - 22px - 1em);
  }
  figure pre {
    display: block;
    width: calc(100% - 25px);
  }
  :is(pre, svg) + .pilcrow {
    display: inline-block;
    vertical-align: text-bottom;
    padding-bottom: 8px;
  }
}

/* aside, blockquote */
aside, blockquote {
  margin-left: 0;
  padding: 0 2em;
  font-style: italic;
}
blockquote {
  margin: 1em 0;
}
cite {
  display: block;
  text-align: right;
  font-style: italic;
}

/* tables */
table {
  max-width: 100%;
  margin: 0 0 1em;
  border-collapse: collapse;
}
table.right {
  margin-left: auto;
}
table.center {
  margin-left: auto;
  margin-right: auto;
}
table.left {
  margin-right: auto;
}
thead, tbody {
  border: 1px solid var(--line-color);
}
th, td {
  text-align: left;
  vertical-align: top;
  padding: 5px 10px;
}
th {
  background-color: var(--line-color);
}
:is(tr:nth-child(2n), thead+tbody > tr:nth-child(2n+1)) > td {
  background-color: var(--background-color);
}
:is(tr:nth-child(2n+1), thead+tbody > tr:nth-child(2n)) > td {
  background-color: var(--highlight-color);
}
table caption {
  margin: 0;
  padding: 3px 0 3px 1em;
}
table p {
  margin: 0;
}

/* pilcrow */
a.pilcrow {
  margin-left: 3px;
  opacity: 0.2;
  user-select: none;
}
a.pilcrow[href] { color: var(--pilcrow-weak); }
a.pilcrow[href]:hover { text-decoration: none; }
@media not print {
  :hover > a.pilcrow {
    opacity: 1;
  }
  a.pilcrow[href]:hover {
    color: var(--pilcrow-strong);
    background-color: transparent;
  }
}
@media print {
  a.pilcrow {
    display: none;
  }
}

/* misc */
hr {
  border: 0;
  border-top: 1px solid var(--line-color);
}
.bcp14 {
  font-variant: small-caps;
  font-weight: 600;
  font-size: var(--small-font-size);
}
.role {
  font-variant: all-small-caps;
}
sub, sup {
  line-height: 1;
  font-size: 80%;
}

/* info block */
#identifiers {
  margin: 0;
  font-size: var(--small-font-size);
  line-height: 18px;
  --identifier-width: 15ch;
}
#identifiers dt {
  width: var(--identifier-width);
  min-width: var(--identifier-width);
  clear: left;
  float: left;
  text-align: right;
  margin-right: 1ch;
}
#identifiers dd {
  margin: 0;
  margin-left: calc(1em + var(--identifier-width)) !important;
  min-width: 5em;
}
#identifiers .authors .author {
  display: inline-block;
  margin-right: 1.5em;
}
#identifiers .authors .org {
  font-style: italic;
}

/* The prepared/rendered info at the very bottom of the page */
.docInfo {
  color: #999;
  font-size: 0.9em;
  font-style: italic;
  margin-top: 2em;
}
.docInfo .prepared {
  float: left;
}
.docInfo .prepared {
  float: right;
}

/* table of contents */
#toc {
  padding: 0.75em 0 2em 0;
  margin-bottom: 1em;
}
#toc nav ul {
  margin: 0 0.5em 0 0;
  padding: 0;
  list-style: none;
}
#toc nav li {
  line-height: 1.3em;
  margin: 2px 0;
  padding-left: 1.2em;
  text-indent: -1.2em;
}
#toc a.xref {
  white-space: normal;
}
/* references */
.references dt {
  text-align: right;
  font-weight: bold;
  min-width: 10ch;
  margin-right: 1.5ch;
}
.references dt:target::before {
  content: "⇒";
  width: 15px;
  margin: 0 10px 0 -25px;
}
.references dd {
  margin-left: 12ch !important;
  overflow: auto;
}

.refInstance {
  margin-bottom: 1.25em;
}

.references .ascii {
  margin-bottom: 0.25em;
}

/* index */
#rfc\.index\.index + ul {
  margin-left: 0;
}

/* authors */
address.vcard {
  font-style: normal;
  margin: 1em 0;
}
address.vcard .nameRole {
  font-weight: 700;
  margin-left: 0;
}
address.vcard .label {
  margin: 0.5em 0;
}
address.vcard .type {
  display: none;
}
.alternative-contact {
  margin: 1.5em 0 1em;
}
hr.addr {
  border-top: 1px dashed;
  margin: 0;
  color: #ddd;
  max-width: calc(100% - 16px);
}
@media (min-width: 500px) {
  #authors-addresses > section {
    column-count: 2;
    column-gap: 20px;
  }
  #authors-addresses > section > h2 {
    column-span: all;
  }
  /* hack for break-inside: avoid-column */
  #authors-addresses address {
    display: inline-block;
    break-inside: avoid-column;
  }
}

.rfcEditorRemove p:first-of-type {
  font-style: italic;
}
.cref {
  background-color: rgba(249, 232, 105, 0.3);
  padding: 2px 4px;
}
.crefSource {
  font-style: italic;
}
/* alternative layout for smaller screens */
@media screen and (max-width: 929px) {
  #toc {
    position: fixed;
    z-index: 2;
    top: 0;
    right: 0;
    padding: 1px 0 0 0;
    margin: 0;
    border-bottom: 1px solid #ccc;
    opacity: 0.6;
  }
  #toc.active {
      opacity: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 2px 0 2px 6px;
    padding-right: 1em;
    font-size: 18px;
    line-height: 24px;
    min-width: 190px;
    text-align: right;
    background-color: #444;
    color: white;
    cursor: pointer;
  }
  #toc h2::before { /* css hamburger */
    float: right;
    position: relative;
    width: 1em;
    height: 1px;
    left: -164px;
    margin: 8px 0 0 0;
    background: white none repeat scroll 0 0;
    box-shadow: 0 4px 0 0 white, 0 8px 0 0 white;
    content: "";
  }
  #toc nav {
    display: none;
    background-color: var(--background-color);
    padding: 0.5em 1em 1em;
    overflow: auto;
    overscroll-behavior: contain;
    height: calc(100vh - 48px);
    border-left: 1px solid #ddd;
  }
  #toc.active nav {
    display: block;
  }
  /* Make the collapsed ToC header render white on gray also when it's a link */
  #toc h2 a,
  #toc h2 a:link,
  #toc h2 a:focus,
  #toc h2 a:hover,
  #toc a.toplink,
  #toc a.toplink:hover {
    color: white;
    background-color: #444;
    text-decoration: none;
  }
  #toc a.toplink {
    margin-top: 2px;
  }
}

/* alternative layout for wide screens */
@media screen and (min-width: 930px) {
  body {
    padding-right: 360px;
    padding-right: calc(min(180px + 20%, 500px));
  }
  #toc {
    position: fixed;
    bottom: 0;
    right: 0;
    right: calc(50vw - 480px);
    width: 312px;
    margin: 0;
    padding: 0;
    z-index: 1;
  }
  #toc h2 {
    margin: 0;
    padding: 0.25em 1em 1em 0;
  }
  #toc nav {
    display: block;
    height: calc(90vh - 84px);
    bottom: 0;
    padding: 0.5em 0 2em;
    overflow: auto;
    overscroll-behavior: contain;
    scrollbar-width: thin;
  }
  #toc nav > ul  {
    margin-bottom: 2em;
  }
  #toc ul {
    margin: 0 0 0 4px;
    font-size: var(--small-font-size);
  }
  #toc ul :is(p, li) {
    margin: 2px 0;
    line-height: 22px;
  }
  img { /* future proofing */
    max-width: 100%;
    height: auto;
  }
}

/* pagination */
@media print {
  body {
    width: 100%;
  }
  p {
    orphans: 3;
    widows: 3;
  }
  #n-copyright-notice {
    border-bottom: none;
  }
  #toc, #n-introduction {
    page-break-before: always;
  }
  #toc {
    border-top: none;
    padding-top: 0;
  }
  figure, pre, .vcard {
    page-break-inside: avoid;
  }
  h1, h2, h3, h4, h5, h6 {
    page-break-after: avoid;
  }
  :is(h2, h3, h4, h5, h6)+*, dd {
    page-break-before: avoid;
  }
  pre {
    white-space: pre-wrap;
    word-wrap: break-word;
    font-size: 10pt;
  }
  table {
    border: 1px solid #ddd;
  }
  td {
    border-top: 1px solid #ddd;
  }
  .toplink {
    display: none;
  }
}

@page :first {
  padding-top: 0;
  @top-left {
    content: normal;
    border: none;
  }
  @top-center {
    content: normal;
    border: none;
  }
  @top-right {
    content: normal;
    border: none;
  }
}

@page {
  size: A4;
  margin-bottom: 45mm;
  padding-top: 20px;
}

/* Changes introduced to fix issues found during implementation */

/* Separate body from document info even without intervening H1 */
section {
  clear: both;
}

/* Top align author divs, to avoid names without organization dropping level with org names */
.author {
  vertical-align: top;
}

/* Style section numbers with more space between number and title */
.section-number {
  padding-right: 0.5em;
}

/* Add styling for a link in the ToC that points to the top of the document */
a.toplink {
  float: right;
  margin: 8px 0.5em 0;
}

/* Provide styling for table cell text alignment */
table .text-left {
  text-align: left;
}
table .text-center {
  text-align: center;
}
table .text-right {
  text-align: right;
}

/* Make the alternative author contact information look less like just another
   author, and group it closer with the primary author contact information */
.alternative-contact {
  margin: 0.5em 0 0.25em 0;
}
address .non-ascii {
  margin: 0 0 0 2em;
}

/* With it being possible to set tables with alignment
  left, center, and right, { width: 100%; } does not make sense */
table {
  width: auto;
}

/* Avoid reference text that sits in a block with very wide left margin,
   because of a long floating dt label.*/
.references dd {
  overflow: visible;
}

/* Control caption placement */
caption {
  caption-side: bottom;
}

/* Limit the width of the author address vcard, so names in right-to-left
   script don't end up on the other side of the page. */

address.vcard {
  max-width: 20em;
  margin-right: auto;
}

/* For address alignment dependent on LTR or RTL scripts */
address div.left {
  text-align: left;
}
address div.right {
  text-align: right;
}

/* Dark mode. */
@media (prefers-color-scheme: dark) {
:root {
  --background-color: #121212;
  --text-color: #f0f0f0;
  --title-color: #fff;
  --link-color: #4da4f0;
  --highlight-color: #282828;
  --line-color: #444;
  --pilcrow-weak: #444;
  --pilcrow-strong: #666;
  scrollbar-color: #777 #333;
}
}

/* SVG Trick: a prefix match works because only black and white are allowed */
svg :is([stroke="black"], [stroke^="#000"]) {
  stroke: var(--text-color);
}
svg :is([stroke="white"], [stroke^="#fff"]) {
  stroke: var(--background-color);
}
svg :is([fill="black"], [fill^="#000"], :not([fill])) {
  fill: var(--text-color);
}
svg :is([fill="white"], [fill^="#fff"]) {
  fill: var(--background-color);
}
</style>

</head>
<body class="xml2rfc">
<table class="ears">
<thead><tr>
<td class="left">Internet-Draft</td>
<td class="center">Using EDHOC with CoAP and OSCORE</td>
<td class="right">March 2024</td>
</tr></thead>
<tfoot><tr>
<td class="left">Palombini, et al.</td>
<td class="center">Expires 30 September 2024</td>
<td class="right">[Page]</td>
</tr></tfoot>
</table>
<div id="external-metadata" class="document-information"></div>
<div id="internal-metadata" class="document-information">
<dl id="identifiers">
<dt class="label-workgroup">Workgroup:</dt>
<dd class="workgroup">CoRE Working Group</dd>
<dt class="label-internet-draft">Internet-Draft:</dt>
<dd class="internet-draft">draft-ietf-core-oscore-edhoc-latest</dd>
<dt class="label-published">Published:</dt>
<dd class="published">
<time datetime="2024-03-29" class="published">29 March 2024</time>
    </dd>
<dt class="label-intended-status">Intended Status:</dt>
<dd class="intended-status">Standards Track</dd>
<dt class="label-expires">Expires:</dt>
<dd class="expires"><time datetime="2024-09-30">30 September 2024</time></dd>
<dt class="label-authors">Authors:</dt>
<dd class="authors">
<div class="author">
      <div class="author-name">F. Palombini</div>
<div class="org">Ericsson</div>
</div>
<div class="author">
      <div class="author-name">M. Tiloca</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">R. Höglund</div>
<div class="org">RISE AB</div>
</div>
<div class="author">
      <div class="author-name">S. Hristozov</div>
<div class="org">Fraunhofer AISEC</div>
</div>
<div class="author">
      <div class="author-name">G. Selander</div>
<div class="org">Ericsson</div>
</div>
</dd>
</dl>
</div>
<h1 id="title">Using Ephemeral Diffie-Hellman Over COSE (EDHOC) with the Constrained Application Protocol (CoAP) and Object Security for Constrained RESTful Environments (OSCORE)</h1>
<section id="section-abstract">
      <h2 id="abstract"><a href="#abstract" class="selfRef">Abstract</a></h2>
<p id="section-abstract-1">The lightweight authenticated key exchange protocol Ephemeral Diffie-Hellman Over COSE (EDHOC) can be run over the Constrained Application Protocol (CoAP) and used by two peers to establish a Security Context for the security protocol Object Security for Constrained RESTful Environments (OSCORE). This document details this use of the EDHOC protocol, by specifying a number of additional and optional mechanisms. These especially include an optimization approach for combining the execution of EDHOC with the first OSCORE transaction. This combination reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-abstract-1" class="pilcrow">¶</a></p>
</section>
<section class="note rfcEditorRemove" id="section-note.1">
      <h2 id="name-discussion-venues">
<a href="#name-discussion-venues" class="section-name selfRef">Discussion Venues</a>
      </h2>
<p id="section-note.1-1">This note is to be removed before publishing as an RFC.<a href="#section-note.1-1" class="pilcrow">¶</a></p>
<p id="section-note.1-2">Discussion of this document takes place on the
  Constrained RESTful Environments Working Group mailing list (core@ietf.org),
  which is archived at <span><a href="https://mailarchive.ietf.org/arch/browse/core/">https://mailarchive.ietf.org/arch/browse/core/</a></span>.<a href="#section-note.1-2" class="pilcrow">¶</a></p>
<p id="section-note.1-3">Source for this draft and an issue tracker can be found at
  <span><a href="https://github.com/core-wg/oscore-edhoc">https://github.com/core-wg/oscore-edhoc</a></span>.<a href="#section-note.1-3" class="pilcrow">¶</a></p>
</section>
<div id="status-of-memo">
<section id="section-boilerplate.1">
        <h2 id="name-status-of-this-memo">
<a href="#name-status-of-this-memo" class="section-name selfRef">Status of This Memo</a>
        </h2>
<p id="section-boilerplate.1-1">
        This Internet-Draft is submitted in full conformance with the
        provisions of BCP 78 and BCP 79.<a href="#section-boilerplate.1-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-2">
        Internet-Drafts are working documents of the Internet Engineering Task
        Force (IETF). Note that other groups may also distribute working
        documents as Internet-Drafts. The list of current Internet-Drafts is
        at <span><a href="https://datatracker.ietf.org/drafts/current/">https://datatracker.ietf.org/drafts/current/</a></span>.<a href="#section-boilerplate.1-2" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-3">
        Internet-Drafts are draft documents valid for a maximum of six months
        and may be updated, replaced, or obsoleted by other documents at any
        time. It is inappropriate to use Internet-Drafts as reference
        material or to cite them other than as "work in progress."<a href="#section-boilerplate.1-3" class="pilcrow">¶</a></p>
<p id="section-boilerplate.1-4">
        This Internet-Draft will expire on 30 September 2024.<a href="#section-boilerplate.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="copyright">
<section id="section-boilerplate.2">
        <h2 id="name-copyright-notice">
<a href="#name-copyright-notice" class="section-name selfRef">Copyright Notice</a>
        </h2>
<p id="section-boilerplate.2-1">
            Copyright (c) 2024 IETF Trust and the persons identified as the
            document authors. All rights reserved.<a href="#section-boilerplate.2-1" class="pilcrow">¶</a></p>
<p id="section-boilerplate.2-2">
            This document is subject to BCP 78 and the IETF Trust's Legal
            Provisions Relating to IETF Documents
            (<span><a href="https://trustee.ietf.org/license-info">https://trustee.ietf.org/license-info</a></span>) in effect on the date of
            publication of this document. Please review these documents
            carefully, as they describe your rights and restrictions with
            respect to this document. Code Components extracted from this
            document must include Revised BSD License text as described in
            Section 4.e of the Trust Legal Provisions and are provided without
            warranty as described in the Revised BSD License.<a href="#section-boilerplate.2-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="toc">
<section id="section-toc.1">
        <a href="#" onclick="scroll(0,0)" class="toplink">▲</a><h2 id="name-table-of-contents">
<a href="#name-table-of-contents" class="section-name selfRef">Table of Contents</a>
        </h2>
<nav class="toc"><ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1">
            <p id="section-toc.1-1.1.1" class="keepWithNext"><a href="#section-1" class="auto internal xref">1</a>.  <a href="#name-introduction" class="internal xref">Introduction</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.1.2.1">
                <p id="section-toc.1-1.1.2.1.1" class="keepWithNext"><a href="#section-1.1" class="auto internal xref">1.1</a>.  <a href="#name-terminology" class="internal xref">Terminology</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.2">
            <p id="section-toc.1-1.2.1" class="keepWithNext"><a href="#section-2" class="auto internal xref">2</a>.  <a href="#name-edhoc-overview" class="internal xref">EDHOC Overview</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3">
            <p id="section-toc.1-1.3.1"><a href="#section-3" class="auto internal xref">3</a>.  <a href="#name-edhoc-combined-with-oscore" class="internal xref">EDHOC Combined with OSCORE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.1">
                <p id="section-toc.1-1.3.2.1.1"><a href="#section-3.1" class="auto internal xref">3.1</a>.  <a href="#name-edhoc-option" class="internal xref">EDHOC Option</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2">
                <p id="section-toc.1-1.3.2.2.1"><a href="#section-3.2" class="auto internal xref">3.2</a>.  <a href="#name-client-processing" class="internal xref">Client Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.1">
                    <p id="section-toc.1-1.3.2.2.2.1.1"><a href="#section-3.2.1" class="auto internal xref">3.2.1</a>.  <a href="#name-processing-of-the-edhoc-osc" class="internal xref">Processing of the EDHOC + OSCORE Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.2.2.2">
                    <p id="section-toc.1-1.3.2.2.2.2.1"><a href="#section-3.2.2" class="auto internal xref">3.2.2</a>.  <a href="#name-supporting-block-wise" class="internal xref">Supporting Block-wise</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3">
                <p id="section-toc.1-1.3.2.3.1"><a href="#section-3.3" class="auto internal xref">3.3</a>.  <a href="#name-server-processing" class="internal xref">Server Processing</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.1">
                    <p id="section-toc.1-1.3.2.3.2.1.1"><a href="#section-3.3.1" class="auto internal xref">3.3.1</a>.  <a href="#name-processing-of-the-edhoc-osco" class="internal xref">Processing of the EDHOC + OSCORE Request</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.3.2.2">
                    <p id="section-toc.1-1.3.2.3.2.2.1"><a href="#section-3.3.2" class="auto internal xref">3.3.2</a>.  <a href="#name-supporting-block-wise-2" class="internal xref">Supporting Block-wise</a></p>
</li>
                </ul>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.3.2.4">
                <p id="section-toc.1-1.3.2.4.1"><a href="#section-3.4" class="auto internal xref">3.4</a>.  <a href="#name-example-of-edhoc-oscore-req" class="internal xref">Example of EDHOC + OSCORE Request</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4">
            <p id="section-toc.1-1.4.1"><a href="#section-4" class="auto internal xref">4</a>.  <a href="#name-use-of-edhoc-connection-ide" class="internal xref">Use of EDHOC Connection Identifiers with OSCORE</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1">
                <p id="section-toc.1-1.4.2.1.1"><a href="#section-4.1" class="auto internal xref">4.1</a>.  <a href="#name-additional-processing-of-ed" class="internal xref">Additional Processing of EDHOC Messages</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.1">
                    <p id="section-toc.1-1.4.2.1.2.1.1"><a href="#section-4.1.1" class="auto internal xref">4.1.1</a>.  <a href="#name-initiator-processing-of-mes" class="internal xref">Initiator Processing of Message 1</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.2">
                    <p id="section-toc.1-1.4.2.1.2.2.1"><a href="#section-4.1.2" class="auto internal xref">4.1.2</a>.  <a href="#name-responder-processing-of-mes" class="internal xref">Responder Processing of Message 2</a></p>
</li>
                  <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.4.2.1.2.3">
                    <p id="section-toc.1-1.4.2.1.2.3.1"><a href="#section-4.1.3" class="auto internal xref">4.1.3</a>.  <a href="#name-initiator-processing-of-mess" class="internal xref">Initiator Processing of Message 2</a></p>
</li>
                </ul>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.5">
            <p id="section-toc.1-1.5.1"><a href="#section-5" class="auto internal xref">5</a>.  <a href="#name-extension-and-consistency-o" class="internal xref">Extension and Consistency of Application Profiles</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.6">
            <p id="section-toc.1-1.6.1"><a href="#section-6" class="auto internal xref">6</a>.  <a href="#name-web-linking" class="internal xref">Web Linking</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.7">
            <p id="section-toc.1-1.7.1"><a href="#section-7" class="auto internal xref">7</a>.  <a href="#name-security-considerations" class="internal xref">Security Considerations</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8">
            <p id="section-toc.1-1.8.1"><a href="#section-8" class="auto internal xref">8</a>.  <a href="#name-iana-considerations" class="internal xref">IANA Considerations</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.1">
                <p id="section-toc.1-1.8.2.1.1"><a href="#section-8.1" class="auto internal xref">8.1</a>.  <a href="#name-coap-option-numbers-registr" class="internal xref">CoAP Option Numbers Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.2">
                <p id="section-toc.1-1.8.2.2.1"><a href="#section-8.2" class="auto internal xref">8.2</a>.  <a href="#name-target-attributes-registry" class="internal xref">Target Attributes Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.3">
                <p id="section-toc.1-1.8.2.3.1"><a href="#section-8.3" class="auto internal xref">8.3</a>.  <a href="#name-edhoc-authentication-creden" class="internal xref">EDHOC Authentication Credential Types Registry</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.8.2.4">
                <p id="section-toc.1-1.8.2.4.1"><a href="#section-8.4" class="auto internal xref">8.4</a>.  <a href="#name-expert-review-instructions" class="internal xref">Expert Review Instructions</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9">
            <p id="section-toc.1-1.9.1"><a href="#section-9" class="auto internal xref">9</a>.  <a href="#name-references" class="internal xref">References</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.1">
                <p id="section-toc.1-1.9.2.1.1"><a href="#section-9.1" class="auto internal xref">9.1</a>.  <a href="#name-normative-references" class="internal xref">Normative References</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.9.2.2">
                <p id="section-toc.1-1.9.2.2.1"><a href="#section-9.2" class="auto internal xref">9.2</a>.  <a href="#name-informative-references" class="internal xref">Informative References</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10">
            <p id="section-toc.1-1.10.1"><a href="#appendix-A" class="auto internal xref">Appendix A</a>.  <a href="#name-document-updates" class="internal xref">Document Updates</a></p>
<ul class="compact toc ulBare ulEmpty">
<li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.1">
                <p id="section-toc.1-1.10.2.1.1"><a href="#appendix-A.1" class="auto internal xref">A.1</a>.  <a href="#name-version-10-to-11" class="internal xref">Version -10 to -11</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.2">
                <p id="section-toc.1-1.10.2.2.1"><a href="#appendix-A.2" class="auto internal xref">A.2</a>.  <a href="#name-version-09-to-10" class="internal xref">Version -09 to -10</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.3">
                <p id="section-toc.1-1.10.2.3.1"><a href="#appendix-A.3" class="auto internal xref">A.3</a>.  <a href="#name-version-08-to-09" class="internal xref">Version -08 to -09</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.4">
                <p id="section-toc.1-1.10.2.4.1"><a href="#appendix-A.4" class="auto internal xref">A.4</a>.  <a href="#name-version-07-to-08" class="internal xref">Version -07 to -08</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.5">
                <p id="section-toc.1-1.10.2.5.1"><a href="#appendix-A.5" class="auto internal xref">A.5</a>.  <a href="#name-version-06-to-07" class="internal xref">Version -06 to -07</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.6">
                <p id="section-toc.1-1.10.2.6.1"><a href="#appendix-A.6" class="auto internal xref">A.6</a>.  <a href="#name-version-05-to-06" class="internal xref">Version -05 to -06</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.7">
                <p id="section-toc.1-1.10.2.7.1"><a href="#appendix-A.7" class="auto internal xref">A.7</a>.  <a href="#name-version-04-to-05" class="internal xref">Version -04 to -05</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.8">
                <p id="section-toc.1-1.10.2.8.1"><a href="#appendix-A.8" class="auto internal xref">A.8</a>.  <a href="#name-version-03-to-04" class="internal xref">Version -03 to -04</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.9">
                <p id="section-toc.1-1.10.2.9.1"><a href="#appendix-A.9" class="auto internal xref">A.9</a>.  <a href="#name-version-02-to-03" class="internal xref">Version -02 to -03</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.10">
                <p id="section-toc.1-1.10.2.10.1"><a href="#appendix-A.10" class="auto internal xref">A.10</a>. <a href="#name-version-01-to-02" class="internal xref">Version -01 to -02</a></p>
</li>
              <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.10.2.11">
                <p id="section-toc.1-1.10.2.11.1"><a href="#appendix-A.11" class="auto internal xref">A.11</a>. <a href="#name-version-00-to-01" class="internal xref">Version -00 to -01</a></p>
</li>
            </ul>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.11">
            <p id="section-toc.1-1.11.1"><a href="#appendix-B" class="auto internal xref"></a><a href="#name-acknowledgments" class="internal xref">Acknowledgments</a></p>
</li>
          <li class="compact toc ulBare ulEmpty" id="section-toc.1-1.12">
            <p id="section-toc.1-1.12.1"><a href="#appendix-C" class="auto internal xref"></a><a href="#name-authors-addresses" class="internal xref">Authors' Addresses</a></p>
</li>
        </ul>
</nav>
</section>
</div>
<div id="introduction">
<section id="section-1">
      <h2 id="name-introduction">
<a href="#section-1" class="section-number selfRef">1. </a><a href="#name-introduction" class="section-name selfRef">Introduction</a>
      </h2>
<p id="section-1-1">Ephemeral Diffie-Hellman Over COSE (EDHOC) <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> is a lightweight authenticated key exchange protocol, especially intended for use in constrained scenarios. In particular, EDHOC messages can be transported over the Constrained Application Protocol (CoAP) <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span> and used for establishing a Security Context for Object Security for Constrained RESTful Environments (OSCORE) <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-1-1" class="pilcrow">¶</a></p>
<p id="section-1-2">This document details the use of the EDHOC protocol with CoAP and OSCORE, and specifies a number of additional and optional mechanisms. These especially include an optimization approach that combines the EDHOC execution with the first OSCORE transaction (see <a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a>). This allows for a minimum number of round trips necessary to setup the OSCORE Security Context and complete an OSCORE transaction, e.g., when an IoT device gets configured in a network for the first time.<a href="#section-1-2" class="pilcrow">¶</a></p>
<p id="section-1-3">This optimization is desirable, since the number of message exchanges can have a substantial impact on the latency of conveying the first OSCORE request, when using certain radio technologies.<a href="#section-1-3" class="pilcrow">¶</a></p>
<p id="section-1-4">Without this optimization, it is not possible, not even in theory, to achieve the minimum number of round trips. This optimization makes it possible also in practice, since the message_3 of the EDHOC protocol can be made relatively small (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-1.2" class="relref">Section 1.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), thus allowing additional OSCORE-protected CoAP data within target MTU sizes.<a href="#section-1-4" class="pilcrow">¶</a></p>
<p id="section-1-5">Furthermore, this document defines a number of parameters corresponding to different information elements of an EDHOC application profile (see <a href="#web-linking" class="auto internal xref">Section 6</a>). These can be specified as target attributes in the link to an EDHOC resource associated with that application profile, thus enabling an enhanced discovery of such a resource for CoAP clients.<a href="#section-1-5" class="pilcrow">¶</a></p>
<div id="terminology">
<section id="section-1.1">
        <h3 id="name-terminology">
<a href="#section-1.1" class="section-number selfRef">1.1. </a><a href="#name-terminology" class="section-name selfRef">Terminology</a>
        </h3>
<p id="section-1.1-1">The key words "MUST", "MUST NOT", "REQUIRED", "SHALL", "SHALL
NOT", "SHOULD", "SHOULD NOT", "RECOMMENDED", "NOT RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be interpreted as
described in BCP 14 <span>[<a href="#RFC2119" class="cite xref">RFC2119</a>]</span> <span>[<a href="#RFC8174" class="cite xref">RFC8174</a>]</span> when, and only when, they
appear in all capitals, as shown here.<a href="#section-1.1-1" class="pilcrow">¶</a></p>
<p id="section-1.1-2">The reader is expected to be familiar with terms and concepts defined in CoAP <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>, CBOR <span>[<a href="#RFC8949" class="cite xref">RFC8949</a>]</span>, OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, and EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-1.1-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="overview">
<section id="section-2">
      <h2 id="name-edhoc-overview">
<a href="#section-2" class="section-number selfRef">2. </a><a href="#name-edhoc-overview" class="section-name selfRef">EDHOC Overview</a>
      </h2>
<p id="section-2-1">This section is not normative and summarizes what is specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, in particular its Appendix A.2. Thus, it provides a baseline for the enhancements in the subsequent sections.<a href="#section-2-1" class="pilcrow">¶</a></p>
<p id="section-2-2">The EDHOC protocol specified in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> allows two peers to agree on a cryptographic secret, in a mutually-authenticated way and by using Diffie-Hellman ephemeral keys to achieve forward secrecy. The two peers are denoted as Initiator and Responder, as the one sending or receiving the initial EDHOC message_1, respectively.<a href="#section-2-2" class="pilcrow">¶</a></p>
<p id="section-2-3">After successful processing of EDHOC message_3, both peers agree on a cryptographic secret that can be used to derive further security material, and especially to establish an OSCORE Security Context <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. The Responder can also send an optional EDHOC message_4 to achieve key confirmation, e.g., in deployments where no protected application message is sent from the Responder to the Initiator.<a href="#section-2-3" class="pilcrow">¶</a></p>
<p id="section-2-4"><span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2" class="relref">Appendix A.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> specifies how to transfer EDHOC over CoAP. That is, the EDHOC data (i.e., the EDHOC message possibly with a prepended connection identifier) are transported in the payload of CoAP requests and responses. The default, forward message flow of EDHOC consists in the CoAP client acting as Initiator and the CoAP server acting as Responder (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.1" class="relref">Appendix A.2.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). Alternatively, the two roles can be reversed, as per the reverse message flow of EDHOC (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.2" class="relref">Appendix A.2.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). In the rest of this document, EDHOC messages are considered to be transferred over CoAP.<a href="#section-2-4" class="pilcrow">¶</a></p>
<p id="section-2-5"><a href="#fig-non-combined" class="auto internal xref">Figure 1</a> shows a successful execution of EDHOC, with a CoAP client and a CoAP server running EDHOC as Initiator and Responder, respectively. In particular, it extends Figure 10 from <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.2.1" class="relref">Appendix A.2.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, by highlighting when the two peers perform EDHOC verification and establish the OSCORE Security Context, and by adding an exchange of OSCORE-protected CoAP messages after completing the EDHOC execution.<a href="#section-2-5" class="pilcrow">¶</a></p>
<p id="section-2-6">That is, the client sends a POST request to a reserved <em>EDHOC resource</em> at the server, by default at the Uri-Path "/.well-known/edhoc". The request payload consists of the CBOR simple value "true" (0xf5) concatenated with EDHOC message_1, which also includes the EDHOC connection identifier C_I of the client encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The Content-Format of the request can be set to application/cid-edhoc+cbor-seq.<a href="#section-2-6" class="pilcrow">¶</a></p>
<p id="section-2-7">This triggers the EDHOC execution at the server, which replies with a 2.04 (Changed) response. The response payload consists of EDHOC message_2, which also includes the EDHOC connection identifier C_R of the server encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The Content-Format of the response can be set to application/edhoc+cbor-seq.<a href="#section-2-7" class="pilcrow">¶</a></p>
<p id="section-2-8">Finally, the client sends a POST request to the same EDHOC resource used earlier when it sent EDHOC message_1. The request payload consists of the EDHOC connection identifier C_R encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, concatenated with EDHOC message_3. The Content-Format of the request can be set to application/cid-edhoc+cbor-seq.<a href="#section-2-8" class="pilcrow">¶</a></p>
<p id="section-2-9">After this exchange takes place, and after successful verifications as specified in the EDHOC protocol, the client and server can derive an OSCORE Security Context, as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. After that, they can use OSCORE to protect their communications as per <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>. Note that the EDHOC Connection Identifier C_R is used as the OSCORE Sender ID of the client (see <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). Therefore, C_R is transported in the 'kid' field of the OSCORE Option of the OSCORE Request (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-2-9" class="pilcrow">¶</a></p>
<p id="section-2-10">The client and server are required to agree in advance on certain information and parameters describing how they should use EDHOC. These are specified in an application profile associated with the EDHOC resource addressed (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.9" class="relref">Section 3.9</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-2-10" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-run-sequen"></span><div id="fig-non-combined">
<figure id="figure-1">
        <div id="section-2-11.1">
          <div class="alignCenter art-svg artwork" id="section-2-11.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="768" width="544" viewBox="0 0 544 768" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 64,64 L 64,256" fill="none" stroke="black"></path>
              <path d="M 64,288 L 64,544" fill="none" stroke="black"></path>
              <path d="M 64,592 L 64,752" fill="none" stroke="black"></path>
              <path d="M 488,64 L 488,384" fill="none" stroke="black"></path>
              <path d="M 488,464 L 488,752" fill="none" stroke="black"></path>
              <path d="M 80,96 L 208,96" fill="none" stroke="black"></path>
              <path d="M 336,96 L 472,96" fill="none" stroke="black"></path>
              <path d="M 80,192 L 208,192" fill="none" stroke="black"></path>
              <path d="M 336,192 L 472,192" fill="none" stroke="black"></path>
              <path d="M 80,304 L 208,304" fill="none" stroke="black"></path>
              <path d="M 336,304 L 472,304" fill="none" stroke="black"></path>
              <path d="M 80,480 L 208,480" fill="none" stroke="black"></path>
              <path d="M 336,480 L 472,480" fill="none" stroke="black"></path>
              <path d="M 80,608 L 200,608" fill="none" stroke="black"></path>
              <path d="M 336,608 L 472,608" fill="none" stroke="black"></path>
              <path d="M 80,688 L 200,688" fill="none" stroke="black"></path>
              <path d="M 344,688 L 472,688" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="480,608 468,602.4 468,613.6" fill="black" transform="rotate(0,472,608)"></polygon>
              <polygon class="arrowhead" points="480,304 468,298.4 468,309.6" fill="black" transform="rotate(0,472,304)"></polygon>
              <polygon class="arrowhead" points="480,96 468,90.4 468,101.6" fill="black" transform="rotate(0,472,96)"></polygon>
              <polygon class="arrowhead" points="88,688 76,682.4 76,693.6" fill="black" transform="rotate(180,80,688)"></polygon>
              <polygon class="arrowhead" points="88,480 76,474.4 76,485.6" fill="black" transform="rotate(180,80,480)"></polygon>
              <polygon class="arrowhead" points="88,192 76,186.4 76,197.6" fill="black" transform="rotate(180,80,192)"></polygon>
              <g class="text">
                <text x="36" y="36">CoAP</text>
                <text x="84" y="36">client</text>
                <text x="452" y="36">CoAP</text>
                <text x="500" y="36">server</text>
                <text x="28" y="52">(EDHOC</text>
                <text x="100" y="52">Initiator)</text>
                <text x="428" y="52">(EDHOC</text>
                <text x="500" y="52">Responder)</text>
                <text x="240" y="100">EDHOC</text>
                <text x="296" y="100">Request</text>
                <text x="120" y="116">Header:</text>
                <text x="172" y="116">0.02</text>
                <text x="220" y="116">(POST)</text>
                <text x="128" y="132">Uri-Path:</text>
                <text x="252" y="132">"/.well-known/edhoc"</text>
                <text x="152" y="148">Content-Format:</text>
                <text x="340" y="148">application/cid-edhoc+cbor-seq</text>
                <text x="124" y="164">Payload:</text>
                <text x="184" y="164">true,</text>
                <text x="232" y="164">EDHOC</text>
                <text x="296" y="164">message_1</text>
                <text x="240" y="196">EDHOC</text>
                <text x="300" y="196">Response</text>
                <text x="152" y="212">Header:</text>
                <text x="204" y="212">2.04</text>
                <text x="264" y="212">(Changed)</text>
                <text x="184" y="228">Content-Format:</text>
                <text x="356" y="228">application/edhoc+cbor-seq</text>
                <text x="156" y="244">Payload:</text>
                <text x="216" y="244">EDHOC</text>
                <text x="280" y="244">message_2</text>
                <text x="24" y="276">EDHOC</text>
                <text x="100" y="276">verification</text>
                <text x="240" y="308">EDHOC</text>
                <text x="296" y="308">Request</text>
                <text x="120" y="324">Header:</text>
                <text x="172" y="324">0.02</text>
                <text x="220" y="324">(POST)</text>
                <text x="128" y="340">Uri-Path:</text>
                <text x="252" y="340">"/.well-known/edhoc"</text>
                <text x="152" y="356">Content-Format:</text>
                <text x="340" y="356">application/cid-edhoc+cbor-seq</text>
                <text x="124" y="372">Payload:</text>
                <text x="180" y="372">C_R,</text>
                <text x="224" y="372">EDHOC</text>
                <text x="288" y="372">message_3</text>
                <text x="416" y="404">EDHOC</text>
                <text x="492" y="404">verification</text>
                <text x="488" y="420">+</text>
                <text x="444" y="436">OSCORE</text>
                <text x="488" y="436">Sec</text>
                <text x="520" y="436">Ctx</text>
                <text x="468" y="452">Derivation</text>
                <text x="240" y="484">EDHOC</text>
                <text x="300" y="484">Response</text>
                <text x="152" y="500">Header:</text>
                <text x="204" y="500">2.04</text>
                <text x="264" y="500">(Changed)</text>
                <text x="184" y="516">Content-Format:</text>
                <text x="356" y="516">application/edhoc+cbor-seq</text>
                <text x="156" y="532">Payload:</text>
                <text x="216" y="532">EDHOC</text>
                <text x="280" y="532">message_4</text>
                <text x="28" y="564">OSCORE</text>
                <text x="72" y="564">Sec</text>
                <text x="104" y="564">Ctx</text>
                <text x="52" y="580">Derivation</text>
                <text x="236" y="612">OSCORE</text>
                <text x="296" y="612">Request</text>
                <text x="120" y="628">Header:</text>
                <text x="172" y="628">0.02</text>
                <text x="220" y="628">(POST)</text>
                <text x="120" y="644">OSCORE:</text>
                <text x="160" y="644">{</text>
                <text x="184" y="644">...</text>
                <text x="208" y="644">;</text>
                <text x="236" y="644">kid:</text>
                <text x="272" y="644">C_R</text>
                <text x="296" y="644">}</text>
                <text x="124" y="660">Payload:</text>
                <text x="228" y="660">OSCORE-protected</text>
                <text x="316" y="660">data</text>
                <text x="236" y="692">OSCORE</text>
                <text x="300" y="692">Response</text>
                <text x="232" y="708">Header:</text>
                <text x="284" y="708">2.04</text>
                <text x="344" y="708">(Changed)</text>
                <text x="232" y="724">OSCORE:</text>
                <text x="272" y="724">{</text>
                <text x="296" y="724">...</text>
                <text x="320" y="724">}</text>
                <text x="236" y="740">Payload:</text>
                <text x="340" y="740">OSCORE-protected</text>
                <text x="428" y="740">data</text>
              </g>
            </svg><a href="#section-2-11.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-1" class="selfRef">Figure 1</a>:
<a href="#name-edhoc-and-oscore-run-sequen" class="selfRef">EDHOC and OSCORE run sequentially. The optional message_4 is included in this example, without which that message needs no payload.</a>
        </figcaption></figure>
</div>
<p id="section-2-12">As shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, this sequential flow where EDHOC is run first and then OSCORE is used takes three round trips to complete.<a href="#section-2-12" class="pilcrow">¶</a></p>
<p id="section-2-13"><a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a> defines an optimization for combining EDHOC with the first OSCORE transaction. This reduces the number of round trips required to set up an OSCORE Security Context and to complete an OSCORE transaction using that Security Context.<a href="#section-2-13" class="pilcrow">¶</a></p>
</section>
</div>
<div id="edhoc-in-oscore">
<section id="section-3">
      <h2 id="name-edhoc-combined-with-oscore">
<a href="#section-3" class="section-number selfRef">3. </a><a href="#name-edhoc-combined-with-oscore" class="section-name selfRef">EDHOC Combined with OSCORE</a>
      </h2>
<p id="section-3-1">This section defines an optimization for combining the EDHOC message exchange with the first OSCORE transaction, thus minimizing the number of round trips between the two peers.<a href="#section-3-1" class="pilcrow">¶</a></p>
<p id="section-3-2">This approach can be used only if the default, forward message flow of EDHOC is used, i.e., when the client acts as Initiator and the server acts as Responder. That is, it cannot be used in the case with reversed roles as per the reverse message flow of EDHOC.<a href="#section-3-2" class="pilcrow">¶</a></p>
<p id="section-3-3">When running the sequential flow of <a href="#overview" class="auto internal xref">Section 2</a>, the client has all the information to derive the OSCORE Security Context already after receiving EDHOC message_2 and before sending EDHOC message_3.<a href="#section-3-3" class="pilcrow">¶</a></p>
<p id="section-3-4">Hence, the client can potentially send both EDHOC message_3 and the subsequent OSCORE Request at the same time. On a semantic level, this requires sending two REST requests at once, as in <a href="#fig-combined" class="auto internal xref">Figure 2</a>.<a href="#section-3-4" class="pilcrow">¶</a></p>
<span id="name-edhoc-and-oscore-combined"></span><div id="fig-combined">
<figure id="figure-2">
        <div id="section-3-5.1">
          <div class="alignCenter art-svg artwork" id="section-3-5.1.1">
<svg xmlns="http://www.w3.org/2000/svg" version="1.1" height="576" width="552" viewBox="0 0 552 576" class="diagram" text-anchor="middle" font-family="monospace" font-size="13px" stroke-linecap="round">
              <path d="M 64,64 L 64,240" fill="none" stroke="black"></path>
              <path d="M 64,320 L 64,560" fill="none" stroke="black"></path>
              <path d="M 496,64 L 496,400" fill="none" stroke="black"></path>
              <path d="M 496,480 L 496,560" fill="none" stroke="black"></path>
              <path d="M 80,80 L 216,80" fill="none" stroke="black"></path>
              <path d="M 344,80 L 480,80" fill="none" stroke="black"></path>
              <path d="M 80,176 L 216,176" fill="none" stroke="black"></path>
              <path d="M 344,176 L 480,176" fill="none" stroke="black"></path>
              <path d="M 80,336 L 184,336" fill="none" stroke="black"></path>
              <path d="M 384,336 L 480,336" fill="none" stroke="black"></path>
              <path d="M 80,496 L 200,496" fill="none" stroke="black"></path>
              <path d="M 344,496 L 480,496" fill="none" stroke="black"></path>
              <polygon class="arrowhead" points="488,336 476,330.4 476,341.6" fill="black" transform="rotate(0,480,336)"></polygon>
              <polygon class="arrowhead" points="488,80 476,74.4 476,85.6" fill="black" transform="rotate(0,480,80)"></polygon>
              <polygon class="arrowhead" points="88,496 76,490.4 76,501.6" fill="black" transform="rotate(180,80,496)"></polygon>
              <polygon class="arrowhead" points="88,176 76,170.4 76,181.6" fill="black" transform="rotate(180,80,176)"></polygon>
              <g class="text">
                <text x="36" y="36">CoAP</text>
                <text x="84" y="36">client</text>
                <text x="460" y="36">CoAP</text>
                <text x="508" y="36">server</text>
                <text x="28" y="52">(EDHOC</text>
                <text x="100" y="52">Initiator)</text>
                <text x="436" y="52">(EDHOC</text>
                <text x="508" y="52">Responder)</text>
                <text x="248" y="84">EDHOC</text>
                <text x="304" y="84">Request</text>
                <text x="120" y="100">Header:</text>
                <text x="172" y="100">0.02</text>
                <text x="220" y="100">(POST)</text>
                <text x="128" y="116">Uri-Path:</text>
                <text x="252" y="116">"/.well-known/edhoc"</text>
                <text x="152" y="132">Content-Format:</text>
                <text x="340" y="132">application/cid-edhoc+cbor-seq</text>
                <text x="124" y="148">Payload:</text>
                <text x="184" y="148">true,</text>
                <text x="232" y="148">EDHOC</text>
                <text x="296" y="148">message_1</text>
                <text x="248" y="180">EDHOC</text>
                <text x="308" y="180">Response</text>
                <text x="160" y="196">Header:</text>
                <text x="224" y="196">Changed</text>
                <text x="284" y="196">(2.04)</text>
                <text x="192" y="212">Content-Format:</text>
                <text x="364" y="212">application/edhoc+cbor-seq</text>
                <text x="164" y="228">Payload:</text>
                <text x="224" y="228">EDHOC</text>
                <text x="288" y="228">message_2</text>
                <text x="24" y="260">EDHOC</text>
                <text x="100" y="260">verification</text>
                <text x="64" y="276">+</text>
                <text x="36" y="292">OSCORE</text>
                <text x="80" y="292">Sec</text>
                <text x="112" y="292">Ctx</text>
                <text x="68" y="308">Derivation</text>
                <text x="216" y="340">EDHOC</text>
                <text x="248" y="340">+</text>
                <text x="284" y="340">OSCORE</text>
                <text x="344" y="340">Request</text>
                <text x="120" y="356">Header:</text>
                <text x="172" y="356">0.02</text>
                <text x="220" y="356">(POST)</text>
                <text x="120" y="372">OSCORE:</text>
                <text x="160" y="372">{</text>
                <text x="184" y="372">...</text>
                <text x="208" y="372">;</text>
                <text x="236" y="372">kid:</text>
                <text x="272" y="372">C_R</text>
                <text x="296" y="372">}</text>
                <text x="124" y="388">Payload:</text>
                <text x="184" y="388">EDHOC</text>
                <text x="248" y="388">message_3</text>
                <text x="296" y="388">+</text>
                <text x="372" y="388">OSCORE-protected</text>
                <text x="460" y="388">data</text>
                <text x="424" y="420">EDHOC</text>
                <text x="500" y="420">verification</text>
                <text x="496" y="436">+</text>
                <text x="444" y="452">OSCORE</text>
                <text x="488" y="452">Sec</text>
                <text x="520" y="452">Ctx</text>
                <text x="484" y="468">Derivation</text>
                <text x="236" y="500">OSCORE</text>
                <text x="300" y="500">Response</text>
                <text x="256" y="516">Header:</text>
                <text x="308" y="516">2.04</text>
                <text x="368" y="516">(Changed)</text>
                <text x="256" y="532">OSCORE:</text>
                <text x="296" y="532">{</text>
                <text x="320" y="532">...</text>
                <text x="344" y="532">}</text>
                <text x="260" y="548">Payload:</text>
                <text x="364" y="548">OSCORE-protected</text>
                <text x="452" y="548">data</text>
              </g>
            </svg><a href="#section-3-5.1.1" class="pilcrow">¶</a>
</div>
</div>
<figcaption><a href="#figure-2" class="selfRef">Figure 2</a>:
<a href="#name-edhoc-and-oscore-combined" class="selfRef">EDHOC and OSCORE combined.</a>
        </figcaption></figure>
</div>
<p id="section-3-6">To this end, the specific approach defined in this section consists of sending a single EDHOC + OSCORE request, which conveys the pair (C_R, EDHOC message_3) within an OSCORE-protected CoAP message.<a href="#section-3-6" class="pilcrow">¶</a></p>
<p id="section-3-7">That is, the EDHOC + OSCORE request is composed of the following two parts combined together in a single CoAP message. The steps for processing the EDHOC + OSCORE request and the two parts combined in there are defined in <a href="#client-processing" class="auto internal xref">Section 3.2.1</a> and <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>.<a href="#section-3-7" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.1">
          <p id="section-3-8.1.1">The OSCORE Request from <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, which is also in this case sent to a protected resource, with the correct CoAP method and options intended for accessing that resource.<a href="#section-3-8.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-3-8.2">
          <p id="section-3-8.2.1">EDHOC data consisting of the pair (C_R, EDHOC message_3) required for completing the EDHOC session, transported as follows:<a href="#section-3-8.2.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3-8.2.2.1">
              <p id="section-3-8.2.2.1.1">C_R is the OSCORE Sender ID of the client and hence transported in the 'kid' field of the OSCORE Option (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>). Unlike in the sequential workflow shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, C_R is thus not transported in the payload of the EDHOC + OSCORE request.<a href="#section-3-8.2.2.1.1" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3-8.2.2.2">
              <p id="section-3-8.2.2.2.1">EDHOC message_3 is transported in the payload of the EDHOC + OSCORE request, prepended to the payload of the OSCORE Request. This is because EDHOC message_3 may be too large to be included in a CoAP Option, e.g., when conveying a large public key certificate chain as ID_CRED_I (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.5.3" class="relref">Section 3.5.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) or when conveying large External Authorization Data as EAD_3 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-3-8.2.2.2.1" class="pilcrow">¶</a></p>
</li>
          </ul>
</li>
      </ul>
<p id="section-3-9">The rest of this section specifies how to transport the data in the EDHOC + OSCORE request and their processing order. In particular, the use of this approach is explicitly signalled by including an EDHOC Option (see <a href="#edhoc-option" class="auto internal xref">Section 3.1</a>) in the EDHOC + OSCORE request. The processing of the EDHOC + OSCORE request is specified in <a href="#client-processing-intro" class="auto internal xref">Section 3.2</a> for the client side and in <a href="#server-processing-intro" class="auto internal xref">Section 3.3</a> for the server side.<a href="#section-3-9" class="pilcrow">¶</a></p>
<div id="edhoc-option">
<section id="section-3.1">
        <h3 id="name-edhoc-option">
<a href="#section-3.1" class="section-number selfRef">3.1. </a><a href="#name-edhoc-option" class="section-name selfRef">EDHOC Option</a>
        </h3>
<p id="section-3.1-1">This section defines the EDHOC Option. The option is used in a CoAP request, to signal that the request payload conveys both an EDHOC message_3 and OSCORE-protected data, combined together.<a href="#section-3.1-1" class="pilcrow">¶</a></p>
<p id="section-3.1-2">The EDHOC Option has the properties summarized in <a href="#fig-edhoc-option" class="auto internal xref">Table 1</a>, which extends Table 4 of <span>[<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>. The option is Critical, Safe-to-Forward, and part of the Cache-Key. The option MUST occur at most once and MUST be empty. If any value is sent, the recipient MUST ignore it. (Future documents may update the definition of the option, by expanding its semantics and specifying admitted values.) The option is intended only for CoAP requests and is of Class U for OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-3.1-2" class="pilcrow">¶</a></p>
<span id="name-the-edhoc-option-ccritical-"></span><div id="fig-edhoc-option">
<table class="center" id="table-1">
          <caption>
<a href="#table-1" class="selfRef">Table 1</a>:
<a href="#name-the-edhoc-option-ccritical-" class="selfRef">The EDHOC Option.  C=Critical, U=Unsafe, N=NoCacheKey, R=Repeatable</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">No.</th>
              <th class="text-left" rowspan="1" colspan="1">C</th>
              <th class="text-left" rowspan="1" colspan="1">U</th>
              <th class="text-left" rowspan="1" colspan="1">N</th>
              <th class="text-left" rowspan="1" colspan="1">R</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Format</th>
              <th class="text-left" rowspan="1" colspan="1">Length</th>
              <th class="text-left" rowspan="1" colspan="1">Default</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">21</td>
              <td class="text-left" rowspan="1" colspan="1">x</td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1"> </td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">Empty</td>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">(none)</td>
            </tr>
          </tbody>
        </table>
</div>
<p id="section-3.1-4">The presence of this option means that the message payload also contains EDHOC data, which must be extracted and processed as defined in <a href="#server-processing-intro" class="auto internal xref">Section 3.3</a>, before the rest of the message can be processed.<a href="#section-3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.1-5"><a href="#fig-edhoc-opt" class="auto internal xref">Figure 3</a> shows an example of a CoAP message transported over UDP and containing both the EDHOC data and the OSCORE ciphertext, using the newly defined EDHOC option for signalling.<a href="#section-3.1-5" class="pilcrow">¶</a></p>
<span id="name-example-of-coap-message-tra"></span><div id="fig-edhoc-opt">
<figure id="figure-3">
          <div class="alignCenter art-text artwork" id="section-3.1-6.1">
<pre>
 0                   1                   2                   3
 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1 2 3 4 5 6 7 8 9 0 1
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|Ver| T |  TKL  |      Code     |          Message ID           |
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Token (if any, TKL bytes) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| Observe Option| OSCORE Option ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
| EDHOC Option  | Other Options (if any) ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
|1 1 1 1 1 1 1 1| Payload ...
+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+-+
</pre>
</div>
<figcaption><a href="#figure-3" class="selfRef">Figure 3</a>:
<a href="#name-example-of-coap-message-tra" class="selfRef">Example of CoAP message transported over UDP, combining EDHOC data and OSCORE data as signalled with the EDHOC Option.</a>
          </figcaption></figure>
</div>
</section>
</div>
<div id="client-processing-intro">
<section id="section-3.2">
        <h3 id="name-client-processing">
<a href="#section-3.2" class="section-number selfRef">3.2. </a><a href="#name-client-processing" class="section-name selfRef">Client Processing</a>
        </h3>
<p id="section-3.2-1">This section describes the processing on the client side.<a href="#section-3.2-1" class="pilcrow">¶</a></p>
<div id="client-processing">
<section id="section-3.2.1">
          <h4 id="name-processing-of-the-edhoc-osc">
<a href="#section-3.2.1" class="section-number selfRef">3.2.1. </a><a href="#name-processing-of-the-edhoc-osc" class="section-name selfRef">Processing of the EDHOC + OSCORE Request</a>
          </h4>
<p id="section-3.2.1-1">The client prepares an EDHOC + OSCORE request as follows.<a href="#section-3.2.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.2.1-2">
<li id="section-3.2.1-2.1">
              <p id="section-3.2.1-2.1.1">Compose EDHOC message_3 into EDHOC_MSG_3, as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.2" class="relref">Section 5.4.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3.2.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.2">
              <p id="section-3.2.1-2.2.1">Establish the new OSCORE Security Context and use it to encrypt the original CoAP request as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.1" class="relref">Section 8.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-3.2.1-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2.2.2">
Note that the OSCORE ciphertext is not computed over EDHOC message_3, which is not protected by OSCORE. That is, the result of this step is the OSCORE Request as in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>.<a href="#section-3.2.1-2.2.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.3">
              <p id="section-3.2.1-2.3.1">Build COMB_PAYLOAD as the concatenation of EDHOC_MSG_3 and OSCORE_PAYLOAD in this order: COMB_PAYLOAD = EDHOC_MSG_3 | OSCORE_PAYLOAD, where | denotes byte string concatenation and:<a href="#section-3.2.1-2.3.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.1-2.3.2.1">
                  <p id="section-3.2.1-2.3.2.1.1">EDHOC_MSG_3 is the binary encoding of EDHOC message_3 resulting from step 1. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.1" class="relref">Section 5.4.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, EDHOC message_3 consists of one CBOR data item CIPHERTEXT_3, which is a CBOR byte string. Therefore, EDHOC_MSG_3 is the binary encoding of CIPHERTEXT_3.<a href="#section-3.2.1-2.3.2.1.1" class="pilcrow">¶</a></p>
</li>
                <li class="normal" id="section-3.2.1-2.3.2.2">
                  <p id="section-3.2.1-2.3.2.2.1">OSCORE_PAYLOAD is the OSCORE ciphertext of the OSCORE-protected CoAP request resulting from step 2.<a href="#section-3.2.1-2.3.2.2.1" class="pilcrow">¶</a></p>
</li>
              </ul>
</li>
            <li id="section-3.2.1-2.4">
              <p id="section-3.2.1-2.4.1">Compose the EDHOC + OSCORE request, as the OSCORE-protected CoAP request resulting from step 2, where the payload is replaced with COMB_PAYLOAD built at step 3.<a href="#section-3.2.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2.4.2">
Note that the new payload includes EDHOC message_3, but it does not include the EDHOC connection identifier C_R. As the client is the EDHOC Initiator, C_R is the OSCORE Sender ID of the client, which is already specified as 'kid' in the OSCORE Option of the request from step 2, hence of the EDHOC + OSCORE request.<a href="#section-3.2.1-2.4.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.5">
              <p id="section-3.2.1-2.5.1">Include the new EDHOC Option defined in <a href="#edhoc-option" class="auto internal xref">Section 3.1</a> into the EDHOC + OSCORE request.<a href="#section-3.2.1-2.5.1" class="pilcrow">¶</a></p>
<p id="section-3.2.1-2.5.2">
The application/cid-edhoc+cbor-seq media type does not apply to this message, whose media type is unnamed.<a href="#section-3.2.1-2.5.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.2.1-2.6">
              <p id="section-3.2.1-2.6.1">Send the EDHOC + OSCORE request to the server.<a href="#section-3.2.1-2.6.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.2.1-3">With the same server, the client SHOULD NOT have multiple simultaneous outstanding interactions (see <span><a href="https://rfc-editor.org/rfc/rfc7252#section-4.7" class="relref">Section 4.7</a> of [<a href="#RFC7252" class="cite xref">RFC7252</a>]</span>) such that: they consist of an EDHOC + OSCORE request; and their EDHOC data pertain to the EDHOC session with the same connection identifier C_R.<a href="#section-3.2.1-3" class="pilcrow">¶</a></p>
<p id="section-3.2.1-4">(An exception might apply for clients that operate under particular time constraints over particularly unreliable networks, thus raising the chances to promptly complete the EDHOC execution with the server through multiple, simultaneous EDHOC + OSCORE requests. As discussed in <a href="#security-considerations" class="auto internal xref">Section 7</a>, this does not have any impact in terms of security.)<a href="#section-3.2.1-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="client-blockwise">
<section id="section-3.2.2">
          <h4 id="name-supporting-block-wise">
<a href="#section-3.2.2" class="section-number selfRef">3.2.2. </a><a href="#name-supporting-block-wise" class="section-name selfRef">Supporting Block-wise</a>
          </h4>
<p id="section-3.2.2-1">If Block-wise <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> is supported, the client may fragment the first application CoAP request before protecting it as an original message with OSCORE, as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.4.1" class="relref">Section 4.1.3.4.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>.<a href="#section-3.2.2-1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-2">In such a case, the OSCORE processing in step 2 of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a> is performed on each inner block of the first application CoAP request, and the following also applies.<a href="#section-3.2.2-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.2.2-3.1">
              <p id="section-3.2.2-3.1.1">The client takes the additional following step between steps 2 and 3 of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2.2-3.1.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3.1.2">
A. If the OSCORE-protected request from step 2 conveys a non-first inner block of the first application CoAP request (i.e., the Block1 Option processed at step 2 had NUM different than 0), then the client skips the following steps and sends the OSCORE-protected request to the server. In particular, the client MUST NOT include the EDHOC Option in the OSCORE-protected request.<a href="#section-3.2.2-3.1.2" class="pilcrow">¶</a></p>
</li>
            <li class="normal" id="section-3.2.2-3.2">
              <p id="section-3.2.2-3.2.1">The client takes the additional following step between steps 3 and 4 of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>.<a href="#section-3.2.2-3.2.1" class="pilcrow">¶</a></p>
<p id="section-3.2.2-3.2.2">
B. If the size of COMB_PAYLOAD exceeds MAX_UNFRAGMENTED_SIZE (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.4.2" class="relref">Section 4.1.3.4.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>), the client MUST stop processing the request and MUST abandon the Block-wise transfer. Then, the client can continue by switching to the sequential workflow shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>. That is, the client first sends EDHOC message_3 prepended by the EDHOC Connection Identifier C_R encoded as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3" class="relref">Section 3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, and then sends the OSCORE-protected CoAP request once the EDHOC execution is completed.<a href="#section-3.2.2-3.2.2" class="pilcrow">¶</a></p>
</li>
          </ul>
<p id="section-3.2.2-4">The performance advantage of using the EDHOC + OSCORE request can be lost when used in combination with Block-wise transfers that rely on specific parameter values and block sizes. Application policies at the CoAP client can define when and how to detect whether the performance advantage is lost, and, if that is the case, whether to appropriately adjust the parameter values and block sizes, or instead to fall back on the sequential workflow of EDHOC.<a href="#section-3.2.2-4" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="server-processing-intro">
<section id="section-3.3">
        <h3 id="name-server-processing">
<a href="#section-3.3" class="section-number selfRef">3.3. </a><a href="#name-server-processing" class="section-name selfRef">Server Processing</a>
        </h3>
<p id="section-3.3-1">This section describes the processing on the server side.<a href="#section-3.3-1" class="pilcrow">¶</a></p>
<div id="server-processing">
<section id="section-3.3.1">
          <h4 id="name-processing-of-the-edhoc-osco">
<a href="#section-3.3.1" class="section-number selfRef">3.3.1. </a><a href="#name-processing-of-the-edhoc-osco" class="section-name selfRef">Processing of the EDHOC + OSCORE Request</a>
          </h4>
<p id="section-3.3.1-1">In order to process a request containing the EDHOC option, i.e., an EDHOC + OSCORE request, the server MUST perform the following steps.<a href="#section-3.3.1-1" class="pilcrow">¶</a></p>
<ol start="1" type="1" class="normal type-1" id="section-3.3.1-2">
<li id="section-3.3.1-2.1">
              <p id="section-3.3.1-2.1.1">Check that the EDHOC + OSCORE request includes the OSCORE option and that the request payload has the format defined at step 3 of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a> for COMB_PAYLOAD. If this is not the case, the server MUST stop processing the request and MUST reply with a 4.00 (Bad Request) error response.<a href="#section-3.3.1-2.1.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.2">
              <p id="section-3.3.1-2.2.1">Extract EDHOC message_3 from the payload COMB_PAYLOAD of the EDHOC + OSCORE request, as the first element EDHOC_MSG_3 (see step 3 of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>).<a href="#section-3.3.1-2.2.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.3">
              <p id="section-3.3.1-2.3.1">Take the value of 'kid' from the OSCORE option of the EDHOC + OSCORE request (i.e., the OSCORE Sender ID of the client), and use it as the EDHOC connection identifier C_R.<a href="#section-3.3.1-2.3.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.4">
              <p id="section-3.3.1-2.4.1">Retrieve the correct EDHOC session by using the connection identifier C_R from step 3.<a href="#section-3.3.1-2.4.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.4.2">
If the application profile used in the EDHOC session specifies that EDHOC message_4 shall be sent, the server MUST stop the EDHOC processing and consider it failed, as due to a client error.<a href="#section-3.3.1-2.4.2" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.4.3">
Otherwise, perform the EDHOC processing on the EDHOC message_3 extracted at step 2 as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, based on the protocol state of the retrieved EDHOC session.<a href="#section-3.3.1-2.4.3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.4.4">
The application profile used in the EDHOC session is the same one associated with the EDHOC resource where the server received the request conveying EDHOC message_1 that started the session. This is relevant in case the server provides multiple EDHOC resources, which may generally refer to different application profiles.<a href="#section-3.3.1-2.4.4" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.5">
              <p id="section-3.3.1-2.5.1">Establish a new OSCORE Security Context associated with the client as per <span><a href="https://rfc-editor.org/rfc/rfc9528#appendix-A.1" class="relref">Appendix A.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, using the EDHOC output from step 4.<a href="#section-3.3.1-2.5.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.6">
              <p id="section-3.3.1-2.6.1">Extract the OSCORE ciphertext from the payload COMB_PAYLOAD of the EDHOC + OSCORE request, as the second element OSCORE_PAYLOAD (see step 3 of <a href="#client-processing" class="auto internal xref">Section 3.2.1</a>).<a href="#section-3.3.1-2.6.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.7">
              <p id="section-3.3.1-2.7.1">Rebuild the OSCORE-protected CoAP request, as the EDHOC + OSCORE request where the payload is replaced with the OSCORE ciphertext extracted at step 6. Then, remove the EDHOC option.<a href="#section-3.3.1-2.7.1" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.8">
              <p id="section-3.3.1-2.8.1">Decrypt and verify the OSCORE-protected CoAP request rebuilt at step 7, as per <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>, by using the OSCORE Security Context established at step 5.<a href="#section-3.3.1-2.8.1" class="pilcrow">¶</a></p>
<p id="section-3.3.1-2.8.2">
When the decrypted request is checked for any critical CoAP options (as it is during regular CoAP processing), the presence of an EDHOC option MUST be regarded as an unprocessed critical option, unless it is processed by some further mechanism.<a href="#section-3.3.1-2.8.2" class="pilcrow">¶</a></p>
</li>
            <li id="section-3.3.1-2.9">
              <p id="section-3.3.1-2.9.1">Deliver the CoAP request resulting from step 8 to the application.<a href="#section-3.3.1-2.9.1" class="pilcrow">¶</a></p>
</li>
          </ol>
<p id="section-3.3.1-3">If steps 4 (EDHOC processing) and 8 (OSCORE processing) are both successfully completed, the server MUST reply with an OSCORE-protected response (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). The usage of EDHOC message_4 as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> is not applicable to the approach defined in this document.<a href="#section-3.3.1-3" class="pilcrow">¶</a></p>
<p id="section-3.3.1-4">If step 4 (EDHOC processing) fails, the server aborts the session as per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.4.3" class="relref">Section 5.4.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> and responds with an EDHOC error message with error code 1, formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. The server MUST NOT establish a new OSCORE Security Context from the present EDHOC session with the client. The CoAP response conveying the EDHOC error message is not protected with OSCORE. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.5" class="relref">Section 9.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, the server has to make sure that the error message does not reveal sensitive information. The CoAP response conveying the EDHOC error message MUST have Content-Format set to application/edhoc+cbor-seq registered in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.9" class="relref">Section 10.9</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-3.3.1-4" class="pilcrow">¶</a></p>
<p id="section-3.3.1-5">If step 4 (EDHOC processing) is successfully completed but step 8 (OSCORE processing) fails, the same OSCORE error handling as defined in <span><a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">Section 8.2</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> applies.<a href="#section-3.3.1-5" class="pilcrow">¶</a></p>
</section>
</div>
<div id="server-blockwise">
<section id="section-3.3.2">
          <h4 id="name-supporting-block-wise-2">
<a href="#section-3.3.2" class="section-number selfRef">3.3.2. </a><a href="#name-supporting-block-wise-2" class="section-name selfRef">Supporting Block-wise</a>
          </h4>
<p id="section-3.3.2-1">If Block-wise <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span> is supported, the server takes the additional following step before any other in <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>.<a href="#section-3.3.2-1" class="pilcrow">¶</a></p>
<p id="section-3.3.2-2">A. If Block-wise is present in the request, then process the Outer Block options according to <span>[<a href="#RFC7959" class="cite xref">RFC7959</a>]</span>, until all blocks of the request have been received (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-4.1.3.4" class="relref">Section 4.1.3.4</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-3.3.2-2" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
<div id="example">
<section id="section-3.4">
        <h3 id="name-example-of-edhoc-oscore-req">
<a href="#section-3.4" class="section-number selfRef">3.4. </a><a href="#name-example-of-edhoc-oscore-req" class="section-name selfRef">Example of EDHOC + OSCORE Request</a>
        </h3>
<p id="section-3.4-1"><a href="#fig-edhoc-opt-2" class="auto internal xref">Figure 4</a> shows an example of EDHOC + OSCORE Request transported over UDP. In particular, the example assumes that:<a href="#section-3.4-1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-2.1">
            <p id="section-3.4-2.1.1">The OSCORE Partial IV in use is 0, consistently with the first request protected with the new OSCORE Security Context.<a href="#section-3.4-2.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.2">
            <p id="section-3.4-2.2.1">The OSCORE Sender ID of the client is 0x01.<a href="#section-3.4-2.2.1" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.2">
As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, this straightforwardly corresponds to the EDHOC connection identifier C_R 0x01.<a href="#section-3.4-2.2.2" class="pilcrow">¶</a></p>
<p id="section-3.4-2.2.3">
As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3.2" class="relref">Section 3.3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, when using the sequential flow shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, the same C_R with value 0x01 would be encoded on the wire as the CBOR integer 1 (0x01 in CBOR encoding), and prepended to EDHOC message_3 in the payload of the second EDHOC request.<a href="#section-3.4-2.2.3" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-2.3">
            <p id="section-3.4-2.3.1">The EDHOC option is registered with CoAP option number 21.<a href="#section-3.4-2.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-3.4-3">Note to RFC Editor: Please delete the last bullet point in the previous list, since, at the time of publication, the CoAP option number will be in fact registered.<a href="#section-3.4-3" class="pilcrow">¶</a></p>
<p id="section-3.4-4">This results in the following components shown in <a href="#fig-edhoc-opt-2" class="auto internal xref">Figure 4</a>:<a href="#section-3.4-4" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-3.4-5.1">
            <p id="section-3.4-5.1.1">OSCORE option value: 0x090001 (3 bytes)<a href="#section-3.4-5.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-5.2">
            <p id="section-3.4-5.2.1">EDHOC option value: - (0 bytes)<a href="#section-3.4-5.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-5.3">
            <p id="section-3.4-5.3.1">EDHOC message_3: 0x52d5535f3147e85f1cfacd9e78abf9e0a81bbf (19 bytes)<a href="#section-3.4-5.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-3.4-5.4">
            <p id="section-3.4-5.4.1">OSCORE ciphertext: 0x612f1092f1776f1c1668b3825e (13 bytes)<a href="#section-3.4-5.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<span id="name-example-of-coap-message-tran"></span><div id="fig-edhoc-opt-2">
<figure id="figure-4">
          <div class="alignCenter art-text art-~ artwork" id="section-3.4-6.1">
<pre>
Protected CoAP request (OSCORE message):

   0x44025d1f               ; CoAP 4-byte header
     00003974               ; Token
     93 090001              ; OSCORE Option
     c0                     ; EDHOC Option
     ff 52d5535f3147e85f1cfacd9e78abf9e0a81bbf
        612f1092f1776f1c1668b3825e
   (46 bytes)
</pre>
</div>
<figcaption><a href="#figure-4" class="selfRef">Figure 4</a>:
<a href="#name-example-of-coap-message-tran" class="selfRef">Example of CoAP message transported over UDP, combining EDHOC data and OSCORE data as signalled with the EDHOC Option.</a>
          </figcaption></figure>
</div>
</section>
</div>
</section>
</div>
<div id="use-of-ids">
<section id="section-4">
      <h2 id="name-use-of-edhoc-connection-ide">
<a href="#section-4" class="section-number selfRef">4. </a><a href="#name-use-of-edhoc-connection-ide" class="section-name selfRef">Use of EDHOC Connection Identifiers with OSCORE</a>
      </h2>
<p id="section-4-1">The OSCORE Sender/Recipient IDs are the EDHOC connection identifiers (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.3.3" class="relref">Section 3.3.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). This applies also to the optimized workflow defined in <a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a> of this document.<a href="#section-4-1" class="pilcrow">¶</a></p>
<p id="section-4-2">Note that, at step 3 of <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>, the value of 'kid' in the OSCORE Option of the EDHOC + OSCORE request is both the server's Recipient ID (i.e., the client's Sender ID) and the EDHOC Connection Identifier C_R of the server.<a href="#section-4-2" class="pilcrow">¶</a></p>
<div id="oscore-edhoc-message-processing">
<section id="section-4.1">
        <h3 id="name-additional-processing-of-ed">
<a href="#section-4.1" class="section-number selfRef">4.1. </a><a href="#name-additional-processing-of-ed" class="section-name selfRef">Additional Processing of EDHOC Messages</a>
        </h3>
<p id="section-4.1-1">When using EDHOC to establish an OSCORE Security Context, the client and server MUST perform the following additional steps during an EDHOC execution, thus extending <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5" class="relref">Section 5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.1-1" class="pilcrow">¶</a></p>
<div id="initiator-processing-of-message-1">
<section id="section-4.1.1">
          <h4 id="name-initiator-processing-of-mes">
<a href="#section-4.1.1" class="section-number selfRef">4.1.1. </a><a href="#name-initiator-processing-of-mes" class="section-name selfRef">Initiator Processing of Message 1</a>
          </h4>
<p id="section-4.1.1-1">The Initiator selects an EDHOC Connection Identifier C_I as follows.<a href="#section-4.1.1-1" class="pilcrow">¶</a></p>
<p id="section-4.1.1-2">The Initiator MUST choose a C_I that is neither used in any current EDHOC session as this peer's EDHOC Connection Identifier, nor the Recipient ID in a current OSCORE Security Context where the ID Context is not present.<a href="#section-4.1.1-2" class="pilcrow">¶</a></p>
<p id="section-4.1.1-3">The chosen C_I SHOULD NOT be the Recipient ID of any current OSCORE Security Context. Note that, unless the two peers concurrently use alternative methods to establish OSCORE Security Contexts, this allows the Responder to always omit the 'kid context' in the OSCORE Option of its messages sent to the Initiator, when protecting those with an OSCORE Security Context where C_I is the Responder's OSCORE Sender ID (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-4.1.1-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="responder-processing-of-message-2">
<section id="section-4.1.2">
          <h4 id="name-responder-processing-of-mes">
<a href="#section-4.1.2" class="section-number selfRef">4.1.2. </a><a href="#name-responder-processing-of-mes" class="section-name selfRef">Responder Processing of Message 2</a>
          </h4>
<p id="section-4.1.2-1">The Responder selects an EDHOC Connection Identifier C_R as follows.<a href="#section-4.1.2-1" class="pilcrow">¶</a></p>
<p id="section-4.1.2-2">The Responder MUST choose a C_R that is neither used in any current EDHOC session as this peer's EDHOC Connection Identifier, nor is equal to the EDHOC Connection Identifier C_I specified in the EDHOC message_1 of the present EDHOC session, nor is the Recipient ID in a current OSCORE Security Context where the ID Context is not present.<a href="#section-4.1.2-2" class="pilcrow">¶</a></p>
<p id="section-4.1.2-3">The chosen C_R SHOULD NOT be the Recipient ID of any current OSCORE Security Context. Note that, for a reason analogous to the one given above with C_I, this allows the Initiator to always omit the 'kid context' in the OSCORE Option of its messages sent to the Responder, when protecting those with an OSCORE Security Context where C_R is the Initiator's OSCORE Sender ID (see <span><a href="https://rfc-editor.org/rfc/rfc8613#section-6.1" class="relref">Section 6.1</a> of [<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-4.1.2-3" class="pilcrow">¶</a></p>
</section>
</div>
<div id="initiator-processing-of-message-2">
<section id="section-4.1.3">
          <h4 id="name-initiator-processing-of-mess">
<a href="#section-4.1.3" class="section-number selfRef">4.1.3. </a><a href="#name-initiator-processing-of-mess" class="section-name selfRef">Initiator Processing of Message 2</a>
          </h4>
<p id="section-4.1.3-1">If the EDHOC Connection Identifier C_I is equal to the EDHOC Connection Identifier C_R specified in EDHOC message_2, then the Initiator MUST abort the session and reply with an EDHOC error message with error code 1, formatted as defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-6.2" class="relref">Section 6.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-4.1.3-1" class="pilcrow">¶</a></p>
</section>
</div>
</section>
</div>
</section>
</div>
<div id="app-statements">
<section id="section-5">
      <h2 id="name-extension-and-consistency-o">
<a href="#section-5" class="section-number selfRef">5. </a><a href="#name-extension-and-consistency-o" class="section-name selfRef">Extension and Consistency of Application Profiles</a>
      </h2>
<p id="section-5-1">It is possible to include the information below in the application profile referred by the client and server, according to the specified consistency rules.<a href="#section-5-1" class="pilcrow">¶</a></p>
<p id="section-5-2">If the server supports the EDHOC + OSCORE request within an EDHOC execution started at a certain EDHOC resource, then the application profile associated with that resource SHOULD explicitly specify support for the EDHOC + OSCORE request.<a href="#section-5-2" class="pilcrow">¶</a></p>
<p id="section-5-3">In case the application profile indicates that the server supports the optional EDHOC message_4 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.5" class="relref">Section 5.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), it is still possible to use the optimized workflow based on the EDHOC + OSCORE request. However, this means the server is not going to send EDHOC message_4, since it is not applicable to the optimized workflow (see <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>).<a href="#section-5-3" class="pilcrow">¶</a></p>
<p id="section-5-4">Also, in case the application profile indicates that the server shall send EDHOC message_4, then the application profile MUST NOT specify support for the EDHOC + OSCORE request, and there is no point for the client to use the optimized workflow, which is bound to fail (see <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>).<a href="#section-5-4" class="pilcrow">¶</a></p>
</section>
</div>
<div id="web-linking">
<section id="section-6">
      <h2 id="name-web-linking">
<a href="#section-6" class="section-number selfRef">6. </a><a href="#name-web-linking" class="section-name selfRef">Web Linking</a>
      </h2>
<p id="section-6-1"><span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.10" class="relref">Section 10.10</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> registers the resource type "core.edhoc", which can be used as target attribute in a web link <span>[<a href="#RFC8288" class="cite xref">RFC8288</a>]</span> to an EDHOC resource, e.g., using a link-format document <span>[<a href="#RFC6690" class="cite xref">RFC6690</a>]</span>. This enables clients to discover the presence of EDHOC resources at a server, possibly using the resource type as filter criterion.<a href="#section-6-1" class="pilcrow">¶</a></p>
<p id="section-6-2">At the same time, the application profile associated with an EDHOC resource provides information describing how the EDHOC protocol can be used through that resource. While a client may become aware of the application profile through several means, it would be convenient to obtain its information elements upon discovering the EDHOC resources at the server. This might aim at discovering especially the EDHOC resources whose associated application profile denotes a way of using EDHOC which is most suitable to the client, e.g., with EDHOC cipher suites or authentication methods that the client also supports or prefers.<a href="#section-6-2" class="pilcrow">¶</a></p>
<p id="section-6-3">That is, it would be convenient that a client discovering an EDHOC resource contextually obtains relevant pieces of information from the application profile associated with that resource. The resource discovery can occur by means of a direct interaction with the server, or instead by means of the CoRE Resource Directory <span>[<a href="#RFC9176" class="cite xref">RFC9176</a>]</span>, where the server may have registered the links to its resources.<a href="#section-6-3" class="pilcrow">¶</a></p>
<p id="section-6-4">In order to enable the above, this section defines a number of parameters, each of which can be optionally specified as a target attribute with the same name in the link to the respective EDHOC resource, or as filter criteria in a discovery request from the client. When specifying these parameters in a link to an EDHOC resource, the target attribute rt="core.edhoc" MUST be included, and the same consistency rules defined in <a href="#app-statements" class="auto internal xref">Section 5</a> for the corresponding information elements of an application profile MUST be followed.<a href="#section-6-4" class="pilcrow">¶</a></p>
<p id="section-6-5">The following parameters are defined.<a href="#section-6-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-6-6.1">
          <p id="section-6-6.1.1">'ed-i', specifying, if present, that the server supports the EDHOC Initiator role, hence the reverse message flow of EDHOC. A value MUST NOT be given to this parameter and any present value MUST be ignored by the recipient.<a href="#section-6-6.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.2">
          <p id="section-6-6.2.1">'ed-r', specifying, if present, that the server supports the EDHOC Responder role, hence the forward message flow of EDHOC. A value MUST NOT be given to this parameter and any present value MUST be ignored by the recipient.<a href="#section-6-6.2.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.3">
          <p id="section-6-6.3.1">'ed-method', specifying an authentication method supported by the server. This parameter MUST specify a single value, which is taken from the 'Value' column of the "EDHOC Method Type" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.3" class="relref">Section 10.3</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying an authentication method.<a href="#section-6-6.3.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.4">
          <p id="section-6-6.4.1">'ed-csuite', specifying an EDHOC cipher suite supported by the server. This parameter MUST specify a single value, which is taken from the 'Value' column of the "EDHOC Cipher Suites" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.2" class="relref">Section 10.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying a cipher suite.<a href="#section-6-6.4.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.5">
          <p id="section-6-6.5.1">'ed-cred-t', specifying a type of authentication credential supported by the server. This parameter MUST specify a single value, which is taken from the 'Value' column of the "EDHOC Authentication Credential Types" Registry defined in <a href="#iana-edhoc-auth-cred-types" class="auto internal xref">Section 8.3</a> of this document. This parameter MAY occur multiple times, with each occurrence specifying a type of authentication credential.<a href="#section-6-6.5.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.6">
          <p id="section-6-6.6.1">'ed-idcred-t', specifying a type of identifier supported by the server for identifying authentication credentials. This parameter MUST specify a single value, which is taken from the 'Label' column of the "COSE Header Parameters" registry <span>[<a href="#COSE.Header.Parameters" class="cite xref">COSE.Header.Parameters</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying a type of identifier for authentication credentials.<a href="#section-6-6.6.1" class="pilcrow">¶</a></p>
<p id="section-6-6.6.2">
Note that the values in the 'Label' column of the "COSE Header Parameters" registry are strongly typed. On the contrary, Link Format is weakly typed and thus does not distinguish between, for instance, the string value "-10" and the integer value -10. Thus, if responses in Link Format are returned, string values which look like an integer are not supported. Therefore, such values MUST NOT be used in the 'ed-idcred-t' parameter.<a href="#section-6-6.6.2" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.7">
          <p id="section-6-6.7.1">'ed-ead', specifying the support of the server for an External Authorization Data (EAD) item (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). This parameter MUST specify a single value, which is taken from the 'Label' column of the "EDHOC External Authorization Data" registry defined in <span><a href="https://rfc-editor.org/rfc/rfc9528#section-10.5" class="relref">Section 10.5</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>. This parameter MAY occur multiple times, with each occurrence specifying the ead_label of an EAD item that the server supports.<a href="#section-6-6.7.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-6-6.8">
          <p id="section-6-6.8.1">'ed-comb-req', specifying, if present, that the server supports the EDHOC + OSCORE request defined in <a href="#edhoc-in-oscore" class="auto internal xref">Section 3</a>. A value MUST NOT be given to this parameter and any present value MUST be ignored by the recipient.<a href="#section-6-6.8.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-6-7">(Future documents may update the definition of the parameters 'ed-i', 'ed-r', and 'ed-comb-req', by expanding their semantics and specifying what they can take as value.)<a href="#section-6-7" class="pilcrow">¶</a></p>
<p id="section-6-8">The example in <a href="#fig-web-link-example" class="auto internal xref">Figure 5</a> shows how a client discovers one EDHOC resource at a server, obtaining information elements from the respective application profile. The Link Format notation from <span><a href="https://rfc-editor.org/rfc/rfc6690#section-5" class="relref">Section 5</a> of [<a href="#RFC6690" class="cite xref">RFC6690</a>]</span> is used.<a href="#section-6-8" class="pilcrow">¶</a></p>
<span id="name-the-web-link"></span><div id="fig-web-link-example">
<figure id="figure-5">
        <div class="alignCenter art-text artwork" id="section-6-9.1">
<pre>
REQ: GET /.well-known/core

RES: 2.05 Content
    &lt;/sensors/temp&gt;;osc,
    &lt;/sensors/light&gt;;if=sensor,
    &lt;/.well-known/edhoc&gt;;rt=core.edhoc;ed-csuite=0;ed-csuite=2;
        ed-method=0;ed-cred-t=1;ed-cred-t=3;ed-idcred-t=4;
        ed-i;ed-r;ed-comb-req
</pre>
</div>
<figcaption><a href="#figure-5" class="selfRef">Figure 5</a>:
<a href="#name-the-web-link" class="selfRef">The Web Link.</a>
        </figcaption></figure>
</div>
</section>
</div>
<div id="security-considerations">
<section id="section-7">
      <h2 id="name-security-considerations">
<a href="#section-7" class="section-number selfRef">7. </a><a href="#name-security-considerations" class="section-name selfRef">Security Considerations</a>
      </h2>
<p id="section-7-1">The same security considerations from OSCORE <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span> and EDHOC <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span> hold for this document. In addition, the following considerations also apply.<a href="#section-7-1" class="pilcrow">¶</a></p>
<p id="section-7-2"><a href="#client-processing" class="auto internal xref">Section 3.2.1</a> specifies that a client SHOULD NOT have multiple outstanding EDHOC + OSCORE requests pertaining to the same EDHOC session. Even if a client did not fulfill this requirement, it would not have any impact in terms of security. That is, the server would still not process different instances of the same EDHOC message_3 more than once in the same EDHOC session (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-5.1" class="relref">Section 5.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), and would still enforce replay protection of the OSCORE-protected request (see Sections <a href="https://rfc-editor.org/rfc/rfc8613#section-7.4" class="relref">7.4</a> and <a href="https://rfc-editor.org/rfc/rfc8613#section-8.2" class="relref">8.2</a> of <span>[<a href="#RFC8613" class="cite xref">RFC8613</a>]</span>).<a href="#section-7-2" class="pilcrow">¶</a></p>
<p id="section-7-3">When using the optimized workflow in <a href="#fig-combined" class="auto internal xref">Figure 2</a>, a minimum of 128-bit security against online brute force attacks is achieved after the client receives and successfully verifies the first OSCORE-protected response (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>). As an example, if EDHOC is used with method 3 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.2" class="relref">Section 3.2</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>) and cipher suite 2 (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.6" class="relref">Section 3.6</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>), then the following holds.<a href="#section-7-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-7-4.1">
          <p id="section-7-4.1.1">The Initiator is authenticated with 128-bit security against online attacks. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, this results from the combination of the strength of the 64-bit MAC in EDHOC message_3 and of the 64-bit MAC in the AEAD of the first OSCORE-protected CoAP request, as rebuilt at step 7 of <a href="#server-processing" class="auto internal xref">Section 3.3.1</a>.<a href="#section-7-4.1.1" class="pilcrow">¶</a></p>
</li>
        <li class="normal" id="section-7-4.2">
          <p id="section-7-4.2.1">The Responder is authenticated with 128-bit security against online attacks. As per <span><a href="https://rfc-editor.org/rfc/rfc9528#section-9.1" class="relref">Section 9.1</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>, this results from the combination of the strength of the 64-bit MAC in EDHOC message_2 and of the 64-bit MAC in the AEAD of the first OSCORE-protected CoAP response.<a href="#section-7-4.2.1" class="pilcrow">¶</a></p>
</li>
      </ul>
<p id="section-7-5">With reference to the sequential workflow in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>, the OSCORE request might have to undergo access control checks at the server, before being actually executed for accessing the target protected resource. The same MUST hold when the optimized workflow in <a href="#fig-combined" class="auto internal xref">Figure 2</a> is used, i.e., when using the EDHOC + OSCORE request.<a href="#section-7-5" class="pilcrow">¶</a></p>
<p id="section-7-6">That is, the rebuilt OSCORE-protected application request from step 7 in <a href="#server-processing" class="auto internal xref">Section 3.3.1</a> MUST undergo the same access control checks that would be performed on a traditional OSCORE-protected application request sent individually as shown in <a href="#fig-non-combined" class="auto internal xref">Figure 1</a>.<a href="#section-7-6" class="pilcrow">¶</a></p>
<p id="section-7-7">To this end, validated information to perform access control checks (e.g., an access token issued by a trusted party) has to be available at the server before starting to process the rebuilt OSCORE-protected application request. Such information may have been provided to the server separately before starting the EDHOC execution altogether, or instead as External Authorization Data during the EDHOC execution (see <span><a href="https://rfc-editor.org/rfc/rfc9528#section-3.8" class="relref">Section 3.8</a> of [<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>).<a href="#section-7-7" class="pilcrow">¶</a></p>
<p id="section-7-8">Thus, a successful completion of the EDHOC protocol and the following derivation of the OSCORE Security Context at the server do not play a role in determining whether the rebuilt OSCORE-protected request is authorized to access the target protected resource at the server.<a href="#section-7-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-considerations">
<section id="section-8">
      <h2 id="name-iana-considerations">
<a href="#section-8" class="section-number selfRef">8. </a><a href="#name-iana-considerations" class="section-name selfRef">IANA Considerations</a>
      </h2>
<p id="section-8-1">This document has the following actions for IANA.<a href="#section-8-1" class="pilcrow">¶</a></p>
<p id="section-8-2">Note to RFC Editor: Please replace all occurrences of "[RFC-XXXX]" with the RFC number of this specification and delete this paragraph.<a href="#section-8-2" class="pilcrow">¶</a></p>
<div id="iana-coap-options">
<section id="section-8.1">
        <h3 id="name-coap-option-numbers-registr">
<a href="#section-8.1" class="section-number selfRef">8.1. </a><a href="#name-coap-option-numbers-registr" class="section-name selfRef">CoAP Option Numbers Registry</a>
        </h3>
<p id="section-8.1-1">IANA is asked to enter the following option number to the "CoAP Option Numbers" registry within the "CoRE Parameters" registry group.<a href="#section-8.1-1" class="pilcrow">¶</a></p>
<span id="name-registrations-in-coap-optio"></span><table class="center" id="table-2">
          <caption>
<a href="#table-2" class="selfRef">Table 2</a>:
<a href="#name-registrations-in-coap-optio" class="selfRef">Registrations in CoAP Option Numbers Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Number</th>
              <th class="text-left" rowspan="1" colspan="1">Name</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">21</td>
              <td class="text-left" rowspan="1" colspan="1">EDHOC</td>
              <td class="text-left" rowspan="1" colspan="1">[RFC-XXXX]</td>
            </tr>
          </tbody>
        </table>
<p id="section-8.1-3">Note to RFC Editor: Please delete this paragraph and all the following text within the present <a href="#iana-coap-options" class="auto internal xref">Section 8.1</a>.<a href="#section-8.1-3" class="pilcrow">¶</a></p>
<p id="section-8.1-4">[<a href="#section-8.1-4" class="pilcrow">¶</a></p>
<p id="section-8.1-5">The CoAP option number 21 is consistent with the properties of the EDHOC Option defined in <a href="#edhoc-option" class="auto internal xref">Section 3.1</a>, and it allows the EDHOC Option to always result in an overall size of 1 byte. This is because:<a href="#section-8.1-5" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.1-6.1">
            <p id="section-8.1-6.1.1">The EDHOC option is always empty, i.e., with zero-length value; and<a href="#section-8.1-6.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.1-6.2">
            <p id="section-8.1-6.2.1">Since the OSCORE Option with option number 9 is always present in the EDHOC + OSCORE request, the EDHOC Option is encoded with a delta equal to at most 12.<a href="#section-8.1-6.2.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.1-7">Although the currently unassigned option number 13 would also work well for the same reasons in the use case in question, different use cases or protocols may make a better use of the option number 13. Hence the preference for the option number 21, and why it is <em>not</em> necessary to register additional option numbers than 21.<a href="#section-8.1-7" class="pilcrow">¶</a></p>
<p id="section-8.1-8">]<a href="#section-8.1-8" class="pilcrow">¶</a></p>
</section>
</div>
<div id="iana-target-attributes">
<section id="section-8.2">
        <h3 id="name-target-attributes-registry">
<a href="#section-8.2" class="section-number selfRef">8.2. </a><a href="#name-target-attributes-registry" class="section-name selfRef">Target Attributes Registry</a>
        </h3>
<p id="section-8.2-1">IANA is asked to register the following entries in the "Target Attributes" registry within the "CoRE Parameters" registry group, as per <span>[<a href="#I-D.ietf-core-target-attr" class="cite xref">I-D.ietf-core-target-attr</a>]</span>.
For all entries, the Change Controller is IETF, and the reference is [RFC-XXXX].<a href="#section-8.2-1" class="pilcrow">¶</a></p>
<span id="name-registrations-in-target-att"></span><table class="center" id="table-3">
          <caption>
<a href="#table-3" class="selfRef">Table 3</a>:
<a href="#name-registrations-in-target-att" class="selfRef">Registrations in Target Attributes Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Attribute Name:</th>
              <th class="text-left" rowspan="1" colspan="1">Brief Description:</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-i</td>
              <td class="text-left" rowspan="1" colspan="1">Hint: support for the EDHOC Initiator role</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-r</td>
              <td class="text-left" rowspan="1" colspan="1">Hint: support for the EDHOC Responder role</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-method</td>
              <td class="text-left" rowspan="1" colspan="1">A supported authentication method for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-csuite</td>
              <td class="text-left" rowspan="1" colspan="1">A supported cipher suite for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-cred-t</td>
              <td class="text-left" rowspan="1" colspan="1">A supported type of authentication credential for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-idcred-t</td>
              <td class="text-left" rowspan="1" colspan="1">A supported type of authentication credential identifier for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-ead</td>
              <td class="text-left" rowspan="1" colspan="1">A supported External Authorization Data (EAD) item for EDHOC</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">ed-comb-req</td>
              <td class="text-left" rowspan="1" colspan="1">Hint: support for the EDHOC+OSCORE request</td>
            </tr>
          </tbody>
        </table>
</section>
</div>
<div id="iana-edhoc-auth-cred-types">
<section id="section-8.3">
        <h3 id="name-edhoc-authentication-creden">
<a href="#section-8.3" class="section-number selfRef">8.3. </a><a href="#name-edhoc-authentication-creden" class="section-name selfRef">EDHOC Authentication Credential Types Registry</a>
        </h3>
<p id="section-8.3-1">IANA is requested to create a new "EDHOC Authentication Credential Types" registry within the "Ephemeral Diffie-Hellman Over COSE (EDHOC)" registry group defined in <span>[<a href="#RFC9528" class="cite xref">RFC9528</a>]</span>.<a href="#section-8.3-1" class="pilcrow">¶</a></p>
<p id="section-8.3-2">The registry uses the "Expert Review" registration procedure <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>. Expert Review guidelines are provided in <a href="#review" class="auto internal xref">Section 8.4</a>.<a href="#section-8.3-2" class="pilcrow">¶</a></p>
<p id="section-8.3-3">The columns of this registry are:<a href="#section-8.3-3" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-4.1">
            <p id="section-8.3-4.1.1">Value: This field contains the value used to identify the type of authentication credential. These values MUST be unique. The value can be an unsigned integer or a negative integer, in the range from -65536 to 65535. Different ranges of values use different registration policies <span>[<a href="#RFC8126" class="cite xref">RFC8126</a>]</span>:<a href="#section-8.3-4.1.1" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.3-4.1.2.1">
                <p id="section-8.3-4.1.2.1.1">Integer values from -24 to 23 are designated as "Standards Action With Expert Review".<a href="#section-8.3-4.1.2.1.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-4.1.2.2">
                <p id="section-8.3-4.1.2.2.1">Integer values from -65536 to -25 and from 24 to 65535 are designated as "Specification Required".<a href="#section-8.3-4.1.2.2.1" class="pilcrow">¶</a></p>
</li>
              <li class="normal" id="section-8.3-4.1.2.3">
                <p id="section-8.3-4.1.2.3.1">Integer values smaller than -65536 and greater than 65535 are marked as "Private Use".<a href="#section-8.3-4.1.2.3.1" class="pilcrow">¶</a></p>
</li>
            </ul>
</li>
          <li class="normal" id="section-8.3-4.2">
            <p id="section-8.3-4.2.1">Description: This field contains a short description of the type of authentication credential.<a href="#section-8.3-4.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.3-4.3">
            <p id="section-8.3-4.3.1">Reference: This field contains a pointer to the public specification for the type of authentication credential.<a href="#section-8.3-4.3.1" class="pilcrow">¶</a></p>
</li>
        </ul>
<p id="section-8.3-5">Initial entries in this registry are as listed in <a href="#pre-reg" class="auto internal xref">Table 4</a>.<a href="#section-8.3-5" class="pilcrow">¶</a></p>
<span id="name-initial-entries-in-the-edho"></span><div id="pre-reg">
<table class="center" id="table-4">
          <caption>
<a href="#table-4" class="selfRef">Table 4</a>:
<a href="#name-initial-entries-in-the-edho" class="selfRef">Initial Entries in the "EDHOC Authentication Credential Types" Registry</a>
          </caption>
<thead>
            <tr>
              <th class="text-left" rowspan="1" colspan="1">Value</th>
              <th class="text-left" rowspan="1" colspan="1">Description</th>
              <th class="text-left" rowspan="1" colspan="1">Reference</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">0</td>
              <td class="text-left" rowspan="1" colspan="1">CBOR Web Token (CWT) containing a COSE_Key in a 'cnf' claim and possibly other claims. CWT is defined in RFC 8392.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">1</td>
              <td class="text-left" rowspan="1" colspan="1">CWT Claims Set (CCS) containing a COSE_Key in a 'cnf' claim and possibly other claims. CCS is defined in RFC 8392.</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC8392" class="cite xref">RFC8392</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">2</td>
              <td class="text-left" rowspan="1" colspan="1">X.509 certificate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#RFC5280" class="cite xref">RFC5280</a>]</span>
</td>
            </tr>
            <tr>
              <td class="text-left" rowspan="1" colspan="1">3</td>
              <td class="text-left" rowspan="1" colspan="1">C509 certificate</td>
              <td class="text-left" rowspan="1" colspan="1">
                <span>[<a href="#I-D.ietf-cose-cbor-encoded-cert" class="cite xref">I-D.ietf-cose-cbor-encoded-cert</a>]</span>
</td>
            </tr>
          </tbody>
        </table>
</div>
</section>
</div>
<div id="review">
<section id="section-8.4">
        <h3 id="name-expert-review-instructions">
<a href="#section-8.4" class="section-number selfRef">8.4. </a><a href="#name-expert-review-instructions" class="section-name selfRef">Expert Review Instructions</a>
        </h3>
<p id="section-8.4-1">The IANA registry established in this document is defined as "Expert Review". This section gives some general guidelines for what the experts should be looking for; but they are being designated as experts for a reason, so they should be given substantial latitude.<a href="#section-8.4-1" class="pilcrow">¶</a></p>
<p id="section-8.4-2">Expert reviewers should take into consideration the following points:<a href="#section-8.4-2" class="pilcrow">¶</a></p>
<ul class="normal">
<li class="normal" id="section-8.4-3.1">
            <p id="section-8.4-3.1.1">Clarity and correctness of registrations. Experts are expected to check the clarity of purpose and use of the requested entries. Experts need to make sure that registered identifiers indicate a type of authentication credential whose format and encoding is clearly defined in the corresponding specification. Identifiers of types of authentication credentials that do not meet these objective of clarity and completeness must not be registered.<a href="#section-8.4-3.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-3.2">
            <p id="section-8.4-3.2.1">Point squatting should be discouraged. Reviewers are encouraged to get sufficient information for registration requests to ensure that the usage is not going to duplicate one that is already registered and that the point is likely to be used in deployments. The zones tagged as "Private Use" are intended for testing purposes and closed environments. Code points in other ranges should not be assigned for testing.<a href="#section-8.4-3.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-3.3">
            <p id="section-8.4-3.3.1">Specifications are required for the "Standards Action With Expert Review" range of point assignment. Specifications should exist for "Specification Required" ranges, but early assignment before a specification is available is considered to be permissible. When specifications are not provided, the description provided needs to have sufficient information to identify what the point is being used for.<a href="#section-8.4-3.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="section-8.4-3.4">
            <p id="section-8.4-3.4.1">Experts should take into account the expected usage of fields when approving point assignment. The fact that there is a range for Standards Track documents does not mean that a Standards Track document cannot have points assigned outside of that range. The length of the encoded value should be weighed against how many code points of that length are left, the size of device it will be used on, and the number of code points left that encode to that size.<a href="#section-8.4-3.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<section id="section-9">
      <h2 id="name-references">
<a href="#section-9" class="section-number selfRef">9. </a><a href="#name-references" class="section-name selfRef">References</a>
      </h2>
<div id="sec-normative-references">
<section id="section-9.1">
        <h3 id="name-normative-references">
<a href="#section-9.1" class="section-number selfRef">9.1. </a><a href="#name-normative-references" class="section-name selfRef">Normative References</a>
        </h3>
<dl class="references">
<dt id="COSE.Header.Parameters">[COSE.Header.Parameters]</dt>
        <dd>
<span class="refAuthor">IANA</span>, <span class="refTitle">"COSE Header Parameters"</span>, <span>&lt;<a href="https://www.iana.org/assignments/cose/cose.xhtml#header-parameters">https://www.iana.org/assignments/cose/cose.xhtml#header-parameters</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="I-D.ietf-core-target-attr">[I-D.ietf-core-target-attr]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span>, <span class="refTitle">"CoRE Target Attributes Registry"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-core-target-attr-06</span>, <time datetime="2023-10-11" class="refDate">11 October 2023</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-core-target-attr-06">https://datatracker.ietf.org/doc/html/draft-ietf-core-target-attr-06</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC2119">[RFC2119]</dt>
        <dd>
<span class="refAuthor">Bradner, S.</span>, <span class="refTitle">"Key words for use in RFCs to Indicate Requirement Levels"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 2119</span>, <span class="seriesInfo">DOI 10.17487/RFC2119</span>, <time datetime="1997-03" class="refDate">March 1997</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC6690">[RFC6690]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Link Format"</span>, <span class="seriesInfo">RFC 6690</span>, <span class="seriesInfo">DOI 10.17487/RFC6690</span>, <time datetime="2012-08" class="refDate">August 2012</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc6690">https://www.rfc-editor.org/rfc/rfc6690</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7252">[RFC7252]</dt>
        <dd>
<span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Hartke, K.</span>, and <span class="refAuthor">C. Bormann</span>, <span class="refTitle">"The Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7252</span>, <span class="seriesInfo">DOI 10.17487/RFC7252</span>, <time datetime="2014-06" class="refDate">June 2014</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7252">https://www.rfc-editor.org/rfc/rfc7252</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC7959">[RFC7959]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">Z. Shelby, Ed.</span>, <span class="refTitle">"Block-Wise Transfers in the Constrained Application Protocol (CoAP)"</span>, <span class="seriesInfo">RFC 7959</span>, <span class="seriesInfo">DOI 10.17487/RFC7959</span>, <time datetime="2016-08" class="refDate">August 2016</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc7959">https://www.rfc-editor.org/rfc/rfc7959</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8126">[RFC8126]</dt>
        <dd>
<span class="refAuthor">Cotton, M.</span>, <span class="refAuthor">Leiba, B.</span>, and <span class="refAuthor">T. Narten</span>, <span class="refTitle">"Guidelines for Writing an IANA Considerations Section in RFCs"</span>, <span class="seriesInfo">BCP 26</span>, <span class="seriesInfo">RFC 8126</span>, <span class="seriesInfo">DOI 10.17487/RFC8126</span>, <time datetime="2017-06" class="refDate">June 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8126">https://www.rfc-editor.org/rfc/rfc8126</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8174">[RFC8174]</dt>
        <dd>
<span class="refAuthor">Leiba, B.</span>, <span class="refTitle">"Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words"</span>, <span class="seriesInfo">BCP 14</span>, <span class="seriesInfo">RFC 8174</span>, <span class="seriesInfo">DOI 10.17487/RFC8174</span>, <time datetime="2017-05" class="refDate">May 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8288">[RFC8288]</dt>
        <dd>
<span class="refAuthor">Nottingham, M.</span>, <span class="refTitle">"Web Linking"</span>, <span class="seriesInfo">RFC 8288</span>, <span class="seriesInfo">DOI 10.17487/RFC8288</span>, <time datetime="2017-10" class="refDate">October 2017</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8288">https://www.rfc-editor.org/rfc/rfc8288</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8613">[RFC8613]</dt>
        <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Mattsson, J.</span>, <span class="refAuthor">Palombini, F.</span>, and <span class="refAuthor">L. Seitz</span>, <span class="refTitle">"Object Security for Constrained RESTful Environments (OSCORE)"</span>, <span class="seriesInfo">RFC 8613</span>, <span class="seriesInfo">DOI 10.17487/RFC8613</span>, <time datetime="2019-07" class="refDate">July 2019</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8613">https://www.rfc-editor.org/rfc/rfc8613</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8949">[RFC8949]</dt>
        <dd>
<span class="refAuthor">Bormann, C.</span> and <span class="refAuthor">P. Hoffman</span>, <span class="refTitle">"Concise Binary Object Representation (CBOR)"</span>, <span class="seriesInfo">STD 94</span>, <span class="seriesInfo">RFC 8949</span>, <span class="seriesInfo">DOI 10.17487/RFC8949</span>, <time datetime="2020-12" class="refDate">December 2020</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8949">https://www.rfc-editor.org/rfc/rfc8949</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9176">[RFC9176]</dt>
        <dd>
<span class="refAuthor">Amsüss, C., Ed.</span>, <span class="refAuthor">Shelby, Z.</span>, <span class="refAuthor">Koster, M.</span>, <span class="refAuthor">Bormann, C.</span>, and <span class="refAuthor">P. van der Stok</span>, <span class="refTitle">"Constrained RESTful Environments (CoRE) Resource Directory"</span>, <span class="seriesInfo">RFC 9176</span>, <span class="seriesInfo">DOI 10.17487/RFC9176</span>, <time datetime="2022-04" class="refDate">April 2022</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9176">https://www.rfc-editor.org/rfc/rfc9176</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC9528">[RFC9528]</dt>
      <dd>
<span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Preuß Mattsson, J.</span>, and <span class="refAuthor">F. Palombini</span>, <span class="refTitle">"Ephemeral Diffie-Hellman Over COSE (EDHOC)"</span>, <span class="seriesInfo">RFC 9528</span>, <span class="seriesInfo">DOI 10.17487/RFC9528</span>, <time datetime="2024-03" class="refDate">March 2024</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc9528">https://www.rfc-editor.org/rfc/rfc9528</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
<div id="sec-informative-references">
<section id="section-9.2">
        <h3 id="name-informative-references">
<a href="#section-9.2" class="section-number selfRef">9.2. </a><a href="#name-informative-references" class="section-name selfRef">Informative References</a>
        </h3>
<dl class="references">
<dt id="I-D.ietf-cose-cbor-encoded-cert">[I-D.ietf-cose-cbor-encoded-cert]</dt>
        <dd>
<span class="refAuthor">Mattsson, J. P.</span>, <span class="refAuthor">Selander, G.</span>, <span class="refAuthor">Raza, S.</span>, <span class="refAuthor">Höglund, J.</span>, and <span class="refAuthor">M. Furuhed</span>, <span class="refTitle">"CBOR Encoded X.509 Certificates (C509 Certificates)"</span>, <span class="refContent">Work in Progress</span>, <span class="seriesInfo">Internet-Draft, draft-ietf-cose-cbor-encoded-cert-09</span>, <time datetime="2024-03-04" class="refDate">4 March 2024</time>, <span>&lt;<a href="https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-09">https://datatracker.ietf.org/doc/html/draft-ietf-cose-cbor-encoded-cert-09</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC5280">[RFC5280]</dt>
        <dd>
<span class="refAuthor">Cooper, D.</span>, <span class="refAuthor">Santesson, S.</span>, <span class="refAuthor">Farrell, S.</span>, <span class="refAuthor">Boeyen, S.</span>, <span class="refAuthor">Housley, R.</span>, and <span class="refAuthor">W. Polk</span>, <span class="refTitle">"Internet X.509 Public Key Infrastructure Certificate and Certificate Revocation List (CRL) Profile"</span>, <span class="seriesInfo">RFC 5280</span>, <span class="seriesInfo">DOI 10.17487/RFC5280</span>, <time datetime="2008-05" class="refDate">May 2008</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc5280">https://www.rfc-editor.org/rfc/rfc5280</a>&gt;</span>. </dd>
<dd class="break"></dd>
<dt id="RFC8392">[RFC8392]</dt>
      <dd>
<span class="refAuthor">Jones, M.</span>, <span class="refAuthor">Wahlstroem, E.</span>, <span class="refAuthor">Erdtman, S.</span>, and <span class="refAuthor">H. Tschofenig</span>, <span class="refTitle">"CBOR Web Token (CWT)"</span>, <span class="seriesInfo">RFC 8392</span>, <span class="seriesInfo">DOI 10.17487/RFC8392</span>, <time datetime="2018-05" class="refDate">May 2018</time>, <span>&lt;<a href="https://www.rfc-editor.org/rfc/rfc8392">https://www.rfc-editor.org/rfc/rfc8392</a>&gt;</span>. </dd>
<dd class="break"></dd>
</dl>
</section>
</div>
</section>
<div id="sec-document-updates">
<section id="appendix-A">
      <h2 id="name-document-updates">
<a href="#appendix-A" class="section-number selfRef">Appendix A. </a><a href="#name-document-updates" class="section-name selfRef">Document Updates</a>
      </h2>
<p id="appendix-A-1">This section is to be removed before publishing as an RFC.<a href="#appendix-A-1" class="pilcrow">¶</a></p>
<div id="sec-10-11">
<section id="appendix-A.1">
        <h3 id="name-version-10-to-11">
<a href="#appendix-A.1" class="section-number selfRef">A.1. </a><a href="#name-version-10-to-11" class="section-name selfRef">Version -10 to -11</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.1-1.1">
            <p id="appendix-A.1-1.1.1">Updated references.<a href="#appendix-A.1-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-09-10">
<section id="appendix-A.2">
        <h3 id="name-version-09-to-10">
<a href="#appendix-A.2" class="section-number selfRef">A.2. </a><a href="#name-version-09-to-10" class="section-name selfRef">Version -09 to -10</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.2-1.1">
            <p id="appendix-A.2-1.1.1">Expanded acronyms in the document title.<a href="#appendix-A.2-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.2">
            <p id="appendix-A.2-1.2.1">Clarified transport of EDHOC C_R and EDHOC message_3.<a href="#appendix-A.2-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.3">
            <p id="appendix-A.2-1.3.1">Simplified text on the use of EDHOC Connection Identifiers as OSCORE Identifiers.<a href="#appendix-A.2-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.4">
            <p id="appendix-A.2-1.4.1">Added the CoAP OSCORE Option in the figures of the EDHOC message flows.<a href="#appendix-A.2-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.5">
            <p id="appendix-A.2-1.5.1">Added more pointers to the message processing, now defined in dedicated subsections.<a href="#appendix-A.2-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.6">
            <p id="appendix-A.2-1.6.1">Detecting and preventing a loss of performance advantage when using Block-wise transfers is for application policies to specifiy.<a href="#appendix-A.2-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.7">
            <p id="appendix-A.2-1.7.1">Clarified use of EDHOC application profiles.<a href="#appendix-A.2-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.8">
            <p id="appendix-A.2-1.8.1">Clarified security considerations on the achieved security level.<a href="#appendix-A.2-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.2-1.9">
            <p id="appendix-A.2-1.9.1">Fixes and editorial improvements.<a href="#appendix-A.2-1.9.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-08-09">
<section id="appendix-A.3">
        <h3 id="name-version-08-to-09">
<a href="#appendix-A.3" class="section-number selfRef">A.3. </a><a href="#name-version-08-to-09" class="section-name selfRef">Version -08 to -09</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.3-1.1">
            <p id="appendix-A.3-1.1.1">Clarified meaning of "EDHOC data".<a href="#appendix-A.3-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.2">
            <p id="appendix-A.3-1.2.1">Improved description of entries for the new IANA registry.<a href="#appendix-A.3-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.3">
            <p id="appendix-A.3-1.3.1">Change Controller changed from "IESG" to "IETF".<a href="#appendix-A.3-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.4">
            <p id="appendix-A.3-1.4.1">Editorial: EDHOC Option number denoted as "21" instead of "TBD21".<a href="#appendix-A.3-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.5">
            <p id="appendix-A.3-1.5.1">Fixed references to sections of draft-ietf-lake-edhoc<a href="#appendix-A.3-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.3-1.6">
            <p id="appendix-A.3-1.6.1">Clarifications and editorial improvements.<a href="#appendix-A.3-1.6.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-07-08">
<section id="appendix-A.4">
        <h3 id="name-version-07-to-08">
<a href="#appendix-A.4" class="section-number selfRef">A.4. </a><a href="#name-version-07-to-08" class="section-name selfRef">Version -07 to -08</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.4-1.1">
            <p id="appendix-A.4-1.1.1">Fixes and clarifications from the Shepherd's review.<a href="#appendix-A.4-1.1.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-06-07">
<section id="appendix-A.5">
        <h3 id="name-version-06-to-07">
<a href="#appendix-A.5" class="section-number selfRef">A.5. </a><a href="#name-version-06-to-07" class="section-name selfRef">Version -06 to -07</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.5-1.1">
            <p id="appendix-A.5-1.1.1">Changed document title.<a href="#appendix-A.5-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.2">
            <p id="appendix-A.5-1.2.1">The client creates the OSCORE Security Context after creating EDHOC message_3.<a href="#appendix-A.5-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.3">
            <p id="appendix-A.5-1.3.1">Revised selection of EDHOC connection identifiers.<a href="#appendix-A.5-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.4">
            <p id="appendix-A.5-1.4.1">Use of "forward message flow" and "reverse message flow".<a href="#appendix-A.5-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.5">
            <p id="appendix-A.5-1.5.1">The payload of the combined request is not a CBOR sequence anymore.<a href="#appendix-A.5-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.6">
            <p id="appendix-A.5-1.6.1">EDHOC error messages from the server are not protected with OSCORE.<a href="#appendix-A.5-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.7">
            <p id="appendix-A.5-1.7.1">More future-proof error handling on the server side.<a href="#appendix-A.5-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.8">
            <p id="appendix-A.5-1.8.1">Target attribute names prefixed by "ed-".<a href="#appendix-A.5-1.8.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.9">
            <p id="appendix-A.5-1.9.1">Defined new target attributes "ed-i" and "ed-r".<a href="#appendix-A.5-1.9.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.10">
            <p id="appendix-A.5-1.10.1">Defined single target attribute "ed-ead" signaling supported EAD items.<a href="#appendix-A.5-1.10.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.11">
            <p id="appendix-A.5-1.11.1">Security consideration on the minimally achieved 128-bit security.<a href="#appendix-A.5-1.11.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.12">
            <p id="appendix-A.5-1.12.1">Defined and used the "EDHOC Authentication Credential Types" Registry.<a href="#appendix-A.5-1.12.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.13">
            <p id="appendix-A.5-1.13.1">High-level sentence replacing the appendix on Block-wise performance.<a href="#appendix-A.5-1.13.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.14">
            <p id="appendix-A.5-1.14.1">Revised examples.<a href="#appendix-A.5-1.14.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.5-1.15">
            <p id="appendix-A.5-1.15.1">Editorial improvements.<a href="#appendix-A.5-1.15.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-05-06">
<section id="appendix-A.6">
        <h3 id="name-version-05-to-06">
<a href="#appendix-A.6" class="section-number selfRef">A.6. </a><a href="#name-version-05-to-06" class="section-name selfRef">Version -05 to -06</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.6-1.1">
            <p id="appendix-A.6-1.1.1">Extended figure on EDHOC sequential workflow.<a href="#appendix-A.6-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.6-1.2">
            <p id="appendix-A.6-1.2.1">Revised naming of target attributes.<a href="#appendix-A.6-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.6-1.3">
            <p id="appendix-A.6-1.3.1">Clarified semantics of target attributes 'eadx'.<a href="#appendix-A.6-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.6-1.4">
            <p id="appendix-A.6-1.4.1">Registration of target attributes.<a href="#appendix-A.6-1.4.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-04-05">
<section id="appendix-A.7">
        <h3 id="name-version-04-to-05">
<a href="#appendix-A.7" class="section-number selfRef">A.7. </a><a href="#name-version-04-to-05" class="section-name selfRef">Version -04 to -05</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.7-1.1">
            <p id="appendix-A.7-1.1.1">Clarifications on Web Linking parameters.<a href="#appendix-A.7-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.7-1.2">
            <p id="appendix-A.7-1.2.1">Added security considerations.<a href="#appendix-A.7-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.7-1.3">
            <p id="appendix-A.7-1.3.1">Revised IANA considerations to focus on the CoAP option number 21.<a href="#appendix-A.7-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.7-1.4">
            <p id="appendix-A.7-1.4.1">Guidelines on using Block-wise moved to an appendix.<a href="#appendix-A.7-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.7-1.5">
            <p id="appendix-A.7-1.5.1">Editorial improvements.<a href="#appendix-A.7-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-03-04">
<section id="appendix-A.8">
        <h3 id="name-version-03-to-04">
<a href="#appendix-A.8" class="section-number selfRef">A.8. </a><a href="#name-version-03-to-04" class="section-name selfRef">Version -03 to -04</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.8-1.1">
            <p id="appendix-A.8-1.1.1">Renamed "applicability statement" to "application profile".<a href="#appendix-A.8-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.2">
            <p id="appendix-A.8-1.2.1">Use the latest Content-Formats.<a href="#appendix-A.8-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.3">
            <p id="appendix-A.8-1.3.1">Use of SHOULD NOT for multiple simultaneous outstanding interactions.<a href="#appendix-A.8-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.4">
            <p id="appendix-A.8-1.4.1">No more special conversion from OSCORE ID to EDHOC ID.<a href="#appendix-A.8-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.5">
            <p id="appendix-A.8-1.5.1">Considerations on using Block-wise.<a href="#appendix-A.8-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.6">
            <p id="appendix-A.8-1.6.1">Wed Linking signaling of multiple supported EAD labels.<a href="#appendix-A.8-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.7">
            <p id="appendix-A.8-1.7.1">Added security considerations.<a href="#appendix-A.8-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.8-1.8">
            <p id="appendix-A.8-1.8.1">Editorial improvements.<a href="#appendix-A.8-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-02-03">
<section id="appendix-A.9">
        <h3 id="name-version-02-to-03">
<a href="#appendix-A.9" class="section-number selfRef">A.9. </a><a href="#name-version-02-to-03" class="section-name selfRef">Version -02 to -03</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.9-1.1">
            <p id="appendix-A.9-1.1.1">Clarifications on transporting EDHOC message_3 in the CoAP payload.<a href="#appendix-A.9-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.2">
            <p id="appendix-A.9-1.2.1">At most one simultaneous outstanding interaction as an EDHOC + OSCORE request with the same server for the same session with connection identifier C_R.<a href="#appendix-A.9-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.3">
            <p id="appendix-A.9-1.3.1">The EDHOC option is removed from the EDHOC + OSCORE request after processing the EDHOC data.<a href="#appendix-A.9-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.4">
            <p id="appendix-A.9-1.4.1">Added explicit constraints when selecting a Recipient ID as C_X.<a href="#appendix-A.9-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.5">
            <p id="appendix-A.9-1.5.1">Added processing steps for when Block-wise is used.<a href="#appendix-A.9-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.6">
            <p id="appendix-A.9-1.6.1">Improved error handling on the server.<a href="#appendix-A.9-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.7">
            <p id="appendix-A.9-1.7.1">Improved section on Web Linking.<a href="#appendix-A.9-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.9-1.8">
            <p id="appendix-A.9-1.8.1">Updated figures; editorial improvements.<a href="#appendix-A.9-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-01-02">
<section id="appendix-A.10">
        <h3 id="name-version-01-to-02">
<a href="#appendix-A.10" class="section-number selfRef">A.10. </a><a href="#name-version-01-to-02" class="section-name selfRef">Version -01 to -02</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.10-1.1">
            <p id="appendix-A.10-1.1.1">New title, abstract and introduction.<a href="#appendix-A.10-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.2">
            <p id="appendix-A.10-1.2.1">Restructured table of content.<a href="#appendix-A.10-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.3">
            <p id="appendix-A.10-1.3.1">Alignment with latest format of EDHOC messages.<a href="#appendix-A.10-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.4">
            <p id="appendix-A.10-1.4.1">Guideline on ID conversions based on application profile.<a href="#appendix-A.10-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.5">
            <p id="appendix-A.10-1.5.1">Clarifications, extension and consistency on application profile.<a href="#appendix-A.10-1.5.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.6">
            <p id="appendix-A.10-1.6.1">Section on web-linking.<a href="#appendix-A.10-1.6.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.7">
            <p id="appendix-A.10-1.7.1">RFC8126 terminology in IANA considerations.<a href="#appendix-A.10-1.7.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.10-1.8">
            <p id="appendix-A.10-1.8.1">Revised Appendix "Checking CBOR Encoding of Numeric Values".<a href="#appendix-A.10-1.8.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
<div id="sec-00-01">
<section id="appendix-A.11">
        <h3 id="name-version-00-to-01">
<a href="#appendix-A.11" class="section-number selfRef">A.11. </a><a href="#name-version-00-to-01" class="section-name selfRef">Version -00 to -01</a>
        </h3>
<ul class="normal">
<li class="normal" id="appendix-A.11-1.1">
            <p id="appendix-A.11-1.1.1">Improved background overview of EDHOC.<a href="#appendix-A.11-1.1.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.11-1.2">
            <p id="appendix-A.11-1.2.1">Added explicit rules for converting OSCORE Sender/Recipient IDs to EDHOC connection identifiers following the removal of bstr_identifier from EDHOC.<a href="#appendix-A.11-1.2.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.11-1.3">
            <p id="appendix-A.11-1.3.1">Revised section organization.<a href="#appendix-A.11-1.3.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.11-1.4">
            <p id="appendix-A.11-1.4.1">Recommended number for EDHOC option changed to 21.<a href="#appendix-A.11-1.4.1" class="pilcrow">¶</a></p>
</li>
          <li class="normal" id="appendix-A.11-1.5">
            <p id="appendix-A.11-1.5.1">Editorial improvements.<a href="#appendix-A.11-1.5.1" class="pilcrow">¶</a></p>
</li>
        </ul>
</section>
</div>
</section>
</div>
<div id="acknowledgments">
<section id="appendix-B">
      <h2 id="name-acknowledgments">
<a href="#name-acknowledgments" class="section-name selfRef">Acknowledgments</a>
      </h2>
<p id="appendix-B-1">The authors sincerely thank <span class="contact-name">Christian Amsüss</span>, <span class="contact-name">Carsten Bormann</span>, <span class="contact-name">Esko Dijk</span>, <span class="contact-name">Joel Halpern</span>, <span class="contact-name">Wes Hardaker</span>, <span class="contact-name">Klaus Hartke</span>, <span class="contact-name">John Preuß Mattsson</span>, <span class="contact-name">David Navarro</span>, <span class="contact-name">Shuping Peng</span>, <span class="contact-name">Jim Schaad</span>, <span class="contact-name">Jürgen Schönwälder</span>, <span class="contact-name">Mališa Vučinić</span>, and <span class="contact-name">Paul Wouters</span> for their feedback and comments.<a href="#appendix-B-1" class="pilcrow">¶</a></p>
<p id="appendix-B-2">The work on this document has been partly supported by VINNOVA and the Celtic-Next project CRITISEC; and by the H2020 project SIFIS-Home (Grant agreement 952652).<a href="#appendix-B-2" class="pilcrow">¶</a></p>
</section>
</div>
<div id="authors-addresses">
<section id="appendix-C">
      <h2 id="name-authors-addresses">
<a href="#name-authors-addresses" class="section-name selfRef">Authors' Addresses</a>
      </h2>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Francesca Palombini</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:francesca.palombini@ericsson.com" class="email">francesca.palombini@ericsson.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Marco Tiloca</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:marco.tiloca@ri.se" class="email">marco.tiloca@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Rikard Höglund</span></div>
<div dir="auto" class="left"><span class="org">RISE AB</span></div>
<div dir="auto" class="left"><span class="street-address">Isafjordsgatan 22</span></div>
<div dir="auto" class="left">SE-<span class="postal-code">16440 Stockholm</span> <span class="locality">Kista</span>
</div>
<div dir="auto" class="left"><span class="country-name">Sweden</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:rikard.hoglund@ri.se" class="email">rikard.hoglund@ri.se</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Stefan Hristozov</span></div>
<div dir="auto" class="left"><span class="org">Fraunhofer AISEC</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:stefan.hristozov@eriptic.com" class="email">stefan.hristozov@eriptic.com</a>
</div>
</address>
<address class="vcard">
        <div dir="auto" class="left"><span class="fn nameRole">Göran Selander</span></div>
<div dir="auto" class="left"><span class="org">Ericsson</span></div>
<div class="email">
<span>Email:</span>
<a href="mailto:goran.selander@ericsson.com" class="email">goran.selander@ericsson.com</a>
</div>
</address>
</section>
</div>
<script>const toc = document.getElementById("toc");
toc.querySelector("h2").addEventListener("click", e => {
  toc.classList.toggle("active");
});
toc.querySelector("nav").addEventListener("click", e => {
  toc.classList.remove("active");
});
</script>
</body>
</html>
